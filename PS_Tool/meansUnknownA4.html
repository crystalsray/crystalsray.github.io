<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solving the Remaining Means</title>
    <link rel="stylesheet" href="css/foundation.min.css">
    <link rel="stylesheet" href="css/app.css">
    <script src="js/mathjs-master/dist/math.js"></script>
  </head>
  <body>
    
    <div class="callout large primary">
      <div class="row column text-center">
        <h1>Principal Stratification Tool</h1>
      </div>
    </div>
    
    <div class="row" id="content">

      <div class="medium-3 medium-offset-1 columns" data-sticky-container>
        <div class="sticky" data-sticky data-anchor="content">
          <ol class="menu vertical">
            <li><a href="index.html"><strong>Start &rarr;</strong> Calculating Bounds for Principal Causal Effects: Interactive Analysis Tool</a></li>
            <li><a href="intro_1a.html">Design Requirements</a></li>
			<li><a href="PS_tool.html"> Identify the Principal Strata for your Study</a></li>
			<li><a href="exclusions_4.html">Use Substantive Assumptions to Restrict the Number of Strata of Interest for these Analyses</a></li>
            <li><a href="pKnown4.html"> Determining Proportions of Subgroups using Observed Quantities</a></li>
            <li><a href="pUnknown4.html">Solving for Proportions that are not Directly Observed</a></li>
            <li><a href="meansIntro4.html">Solving for Means under Treatment and Control</a></li>
			<li><a href="means4.html">Applying the Exclusion Restriction</a></li>
			<li class="active"><a href="meansUnknown4.html">Solving for the Remaining Means</a></li>
            <li><!-- bounds_calc.html -->Calculating the Bounds and Estimating Ranges of Impact</li>
            <li><!-- NextSteps.html -->Next Steps</li>
          </ol>
        </div>
      </div>

      <div class="medium-7 columns">
        <div class="row column">
          <h2>Solving the Remaining Means</h2>
          
         <p id="tableInfo"> </p>
        
        <table id="boundsGrid" class="testgrid" align="center">
            <tr>
              <th colspan=5 class="control-treatment-header" id="group1Name"></th>
            </tr>
            <tr>
              <th rowspan=6 class="control-treatment-header" id="group2Name"></th>
            </tr>
            <tr>
              <th> </th>
              <th id="strata1Name"></th>
              <th id="strata2Name"></th>
              <th id="strata3Name"></th>
              <th id="strata4Name"></th>
            </tr>
            <tr>
              <th id="strata1Name2"></th>
              <td id="strata1Input"> </td>
              <td id="strata2Input"> </td>
              <td id="strata3Input"> </td>
              <td id="strata4Input"> </td>
            </tr>
            <tr>
              <th id="strata2Name2"></th>
              <td id="strata5Input"> </td>
              <td id="strata6Input"> </td>
              <td id="strata7Input"> </td>
              <td id="strata8Input"> </td>
            </tr>
            <tr>
              <th id="strata3Name2"></th>
              <td id="strata9Input"> </td>
              <td id="strata10Input"> </td>
              <td id="strata11Input"> </td>
              <td id="strata12Input"> </td>
            </tr>
            <tr>
              <th id="strata4Name2"></th>
              <td id="strata13Input"> </td>
              <td id="strata14Input"> </td>
              <td id="strata15Input"> </td>
              <td id="strata16Input"> </td>
            </tr>
          </table>


        </div> <!--/ end blog post -->

        <div class="row column">
            <div class="small-12 text-center">
              <button class="button" onclick="submitP()">Continue</button>
            </div>
        </div>

      </div> <!--/ end medium- 7-->

      
      

      <div class="medium-1 columns">&nbsp; <!-- keep column empty, last column spans the remaining width of the page -->
      </div>

    </div><!--/ end row -->
    

    <footer>
      <div class="row expanded callout secondary">
        <div class="medium-10 medium-offset-1 columns">
           <p>Funding for this project was provided by Grant #201500035 from the Spencer Foundation. This website is designed to assist researchers interested in applying a principal stratification approach to their research questions. This tool intended for researchers who have a familiarity with the principal stratification approach. Researchers unfamiliar with the approach are encouraged to consult Page et al 2015 before using this tool.</p>
<br><p>Furey, J., Grindal, T., & Page, L. (2017). Calculating Bounds for Principal Causal Effects: Interactive Analysis Tool (Version 1.0, Software]. Available from <a> www.INSERTPAGE<a>  <p>

        </div>
      </div>


    </footer>
    
    <script src="js/vendor/jquery-2.1.4.min.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <script>

        window.onload = function() {
        var groupNames= new Array();
        var strataNames = new Array();
        var group1 = localStorage.group1Local;
        var group2 = localStorage.group2Local;
        var strata = localStorage.strataLocal;
        strata = strata*strata;
        var strata1 = localStorage.strata1Local;
        var strata2 = localStorage.strata2Local;
        var strata3 = localStorage.strata3Local;
        var strata4 = localStorage.strata4Local;
		var isActive1 = parseInt(localStorage.isActive1);
        var isActive2 = parseInt(localStorage.isActive2);
        var isActive3 = parseInt(localStorage.isActive3);
        var isActive4 = parseInt(localStorage.isActive4);
        var isActive5 = parseInt(localStorage.isActive5);
        var isActive6 = parseInt(localStorage.isActive6);
        var isActive7 = parseInt(localStorage.isActive7);
        var isActive8 = parseInt(localStorage.isActive8);
        var isActive9 = parseInt(localStorage.isActive9);
		var isActive10 = parseInt(localStorage.isActive10);
		var isActive11 = parseInt(localStorage.isActive11);
        var isActive12 = parseInt(localStorage.isActive12);
        var isActive13 = parseInt(localStorage.isActive13);
        var isActive14 = parseInt(localStorage.isActive14);
        var isActive15 = parseInt(localStorage.isActive15);
        var isActive16 = parseInt(localStorage.isActive16);
        var isActive = [isActive1, isActive2, isActive3, isActive4, isActive5, isActive6, isActive7, isActive8, isActive9, isActive10, isActive11, isActive12, isActive13, isActive14, isActive15, isActive16];   
        var pMean1 = localStorage.pMean1;
        var pMean2 = localStorage.pMean2;
        var pMean3 = localStorage.pMean3;
        var pMean4 = localStorage.pMean4;
        var pMean5 = localStorage.pMean5;
        var pMean6 = localStorage.pMean6;
        var pMean7 = localStorage.pMean7;
        var pMean8 = localStorage.pMean8;
        var pMean9 = localStorage.pMean9;
        var pMean10 = localStorage.pMean10;
        var pMean11 = localStorage.pMean11;
        var pMean12 = localStorage.pMean12;
        var pMean13 = localStorage.pMean13;
        var pMean14 = localStorage.pMean14;
        var pMean15 = localStorage.pMean15;
        var pMean16 = localStorage.pMean16;
        var pMean = [pMean1, pMean2, pMean3, pMean4, pMean5, pMean6, pMean7, pMean8, pMean9, pMean10, pMean11, pMean12, pMean13, pMean14, pMean15, pMean16];
        var pMeanKnown1 = localStorage.pMeanKnown1;
        var pMeanKnown2 = localStorage.pMeanKnown2;
        var pMeanKnown3 = localStorage.pMeanKnown3;
        var pMeanKnown4 = localStorage.pMeanKnown4;
        var pMeanKnown5 = localStorage.pMeanKnown5;
        var pMeanKnown6 = localStorage.pMeanKnown6;
        var pMeanKnown7 = localStorage.pMeanKnown7;
        var pMeanKnown8 = localStorage.pMeanKnown8;
        var pMeanKnown9 = localStorage.pMeanKnown9;
        var pMeanKnown10 = localStorage.pMeanKnown10;
        var pMeanKnown11 = localStorage.pMeanKnown11;
        var pMeanKnown12 = localStorage.pMeanKnown12;
        var pMeanKnown13 = localStorage.pMeanKnown13;
        var pMeanKnown14 = localStorage.pMeanKnown14;
        var pMeanKnown15 = localStorage.pMeanKnown15;
        var pMeanKnown16 = localStorage.pMeanKnown16;
        var pMeanKnown = [pMeanKnown1, pMeanKnown2, pMeanKnown3, pMeanKnown4, pMeanKnown5, pMeanKnown6, pMeanKnown7, pMeanKnown8, pMeanKnown9, pMeanKnown10, pMeanKnown11, pMeanKnown12, pMeanKnown13, pMeanKnown14, pMeanKnown15, pMeanKnown16];
        var xMeans1 = localStorage.xMeans1;
        var xMeans2 = localStorage.xMeans2;
        var xMeans3 = localStorage.xMeans3;
        var xMeans4 = localStorage.xMeans4;
        var xMeans5 = localStorage.xMeans5;
        var xMeans6 = localStorage.xMeans6;
        var xMeans7 = localStorage.xMeans7;
        var xMeans8 = localStorage.xMeans8;
        var xMeans9 = localStorage.xMeans9;
        var xMeans10 = localStorage.xMeans10;
        var xMeans11 = localStorage.xMeans11;
        var xMeans12 = localStorage.xMeans12;
        var xMeans13 = localStorage.xMeans13;
        var xMeans14 = localStorage.xMeans14;
        var xMeans15 = localStorage.xMeans15;
        var xMeans16 = localStorage.xMeans16;
        var xMean = [xMeans1, xMeans2, xMeans3, xMeans4, xMeans5, xMeans6, xMeans7, xMeans8, xMeans9, xMeans10, xMeans11, xMeans12, xMeans13, xMeans14, xMeans15, xMeans16];
        var yMeans1 = localStorage.yMeans1;
        var yMeans2 = localStorage.yMeans2;
        var yMeans3 = localStorage.yMeans3;
        var yMeans4 = localStorage.yMeans4;
        var yMeans5 = localStorage.yMeans5;
        var yMeans6 = localStorage.yMeans6;
        var yMeans7 = localStorage.yMeans7;
        var yMeans8 = localStorage.yMeans8;
        var yMeans9 = localStorage.yMeans9;
        var yMeans10 = localStorage.yMeans10;
        var yMeans11 = localStorage.yMeans11;
        var yMeans12 = localStorage.yMeans12;
        var yMeans13 = localStorage.yMeans13;
        var yMeans14 = localStorage.yMeans14;
        var yMeans15 = localStorage.yMeans15;
        var yMeans16 = localStorage.yMeans16;
        var yMean = [yMeans1, yMeans2, yMeans3, yMeans4, yMeans5, yMeans6, yMeans7, yMeans8, yMeans9, yMeans10, yMeans11, yMeans12, yMeans13, yMeans14, yMeans15, yMeans16];
        var MeansKnown1 = localStorage.MeansKnown1;
        var MeansKnown2 = localStorage.MeansKnown2;
        var MeansKnown3 = localStorage.MeansKnown3;
        var MeansKnown4 = localStorage.MeansKnown4;
        var MeansKnown5 = localStorage.MeansKnown5;
        var MeansKnown6 = localStorage.MeansKnown6;
        var MeansKnown7 = localStorage.MeansKnown7;
        var MeansKnown8 = localStorage.MeansKnown8;
        var MeansKnown9 = localStorage.MeansKnown9;
        var MeansKnown10 = localStorage.MeansKnown10;
        var MeansKnown11 = localStorage.MeansKnown11;
        var MeansKnown12 = localStorage.MeansKnown12;
        var MeansKnown13 = localStorage.MeansKnown13;
        var MeansKnown14 = localStorage.MeansKnown14;
        var MeansKnown15 = localStorage.MeansKnown15;
        var MeansKnown16 = localStorage.MeansKnown16;
        var MeansKnown = [MeansKnown1, MeansKnown2, MeansKnown3, MeansKnown4, MeansKnown5, MeansKnown6, MeansKnown7, MeansKnown8, MeansKnown9, MeansKnown10, MeansKnown11, MeansKnown12, MeansKnown13, MeansKnown14, MeansKnown15, MeansKnown16];
       
        var TtoTNum = localStorage.TtoTNum;
        var TtoSub1Num = localStorage.TtoSub1Num;
        var TtoSub2Num = localStorage.TtoSub2Num;
		var TtoSub3Num = localStorage.TtoSub3Num;
        var CtoTNum = localStorage.CtoTNum;
        var CtoSub1Num = localStorage.CtoSub1Num;
        var CtoSub2Num = localStorage.CtoSub2Num;
        var CtoSub3Num = localStorage.CtoSub3Num;
        var TtoT = localStorage.TtoT;
        var TtoSub1 = localStorage.TtoSub1;
        var TtoSub2 = localStorage.TtoSub2;
		var TtoSub3 = localStorage.TtoSub3;
        var CtoT = localStorage.CtoT;
        var CtoSub1 = localStorage.CtoSub1;
        var CtoSub2 = localStorage.CtoSub2;
		var CtoSub3 = localStorage.CtoSub3;
        var UnknownX1 = localStorage.UnknownX1;
        var UnknownX2 = localStorage.UnknownX2;
        var UnknownX3 = localStorage.UnknownX3;
        var UnknownX4 = localStorage.UnknownX4;
        var UnknownX5 = localStorage.UnknownX5;
        var UnknownX6 = localStorage.UnknownX6;
        var UnknownX7 = localStorage.UnknownX7;
        var UnknownX8 = localStorage.UnknownX8;
        var UnknownX9 = localStorage.UnknownX9;
        var UnknownX10 = localStorage.UnknownX10;
        var UnknownX11 = localStorage.UnknownX11;
        var UnknownX12 = localStorage.UnknownX12;
        var UnknownX13 = localStorage.UnknownX13;
        var UnknownX14 = localStorage.UnknownX14;
        var UnknownX15 = localStorage.UnknownX15;
        var UnknownX16 = localStorage.UnknownX16;
        var UnknownX = [UnknownX1, UnknownX2, UnknownX3, UnknownX4, UnknownX5, UnknownX6, UnknownX7, UnknownX8, UnknownX9, UnknownX10, UnknownX11, UnknownX12, UnknownX13, UnknownX14, UnknownX15, UnknownX16];
        var UnknownY1 = localStorage.UnknownY1;
        var UnknownY2 = localStorage.UnknownY2;
        var UnknownY3 = localStorage.UnknownY3;
        var UnknownY4 = localStorage.UnknownY4;
        var UnknownY5 = localStorage.UnknownY5;
        var UnknownY6 = localStorage.UnknownY6;
        var UnknownY7 = localStorage.UnknownY7;
        var UnknownY8 = localStorage.UnknownY8;
        var UnknownY9 = localStorage.UnknownY9;
        var UnknownY10 = localStorage.UnknownY10;
        var UnknownY11 = localStorage.UnknownY11;
        var UnknownY12 = localStorage.UnknownY12;
        var UnknownY13 = localStorage.UnknownY13;
        var UnknownY14 = localStorage.UnknownY14;
        var UnknownY15 = localStorage.UnknownY15;
        var UnknownY16 = localStorage.UnknownY16;
        var UnknownY = [UnknownY1, UnknownY2, UnknownY3, UnknownY4, UnknownY5, UnknownY6, UnknownY7, UnknownY8, UnknownY9, UnknownY10, UnknownY11, UnknownY12, UnknownY13, UnknownY14, UnknownY15, UnknownY16];
       
        document.getElementById('strata1Name').innerHTML = localStorage.strata1Local + " (Y=" + TtoT + "%)";
        document.getElementById('strata2Name').innerHTML = localStorage.strata2Local + " (Y=" + TtoSub1 + "%)";
        document.getElementById('strata3Name').innerHTML = localStorage.strata3Local + " (Y=" + TtoSub2 + "%)";
        document.getElementById('strata4Name').innerHTML = localStorage.strata4Local + " (Y=" + TtoSub3 + "%)";

        document.getElementById('strata1Name2').innerHTML = localStorage.strata1Local + " (Y=" + CtoT + "%)";
        document.getElementById('strata2Name2').innerHTML = localStorage.strata2Local + " (Y=" + CtoSub1 + "%)";
        document.getElementById('strata3Name2').innerHTML = localStorage.strata3Local + " (Y=" + CtoSub2 + "%)";
        document.getElementById('strata4Name2').innerHTML = localStorage.strata4Local + " (Y=" + CtoSub3 + "%)";

        document.getElementById('group1Name').innerHTML = "Assigned to "+group1;
        document.getElementById('group2Name').innerHTML = "Assigned to "+group2;
        document.getElementById('tableInfo').innerHTML = "Knowing the means under "+group1+" and "+group2+" for some of the groups in the grid will allow the tool to solve for the remaining values. For example, we know that the means across a row or down a column must average out to the marginal mean in that row or column. The mean in the margin is the weighted average of the means across the row or down the column. We also know the proportions of participants who are members of the groups represented by each cell in the grid. Using the means we can observe, and these proportions, we may be able to back out some of the mean outcomes under "+group1+" and "+group2+".";
        //gray out excluded cells
        var C = "c";
        var cSub = C.sub();
        var T = "t"
        var tSub = T.sub()      
        var allCells = document.getElementsByTagName("td");
        for(var i = 0; i < strata; i++) {
          var node = allCells[i];
          var cellContent = node.childNodes[0].nodeValue; 
          //check for 'one' and assign this table cell's background color accordingly 
          if (isActive[i]==0)
            node.style.backgroundColor = "#808080";
		  if(isActive[i]==1){
			node.innerHTML = "P="+ Math.round(pMean[i]*1000)/1000+"   Y"+cSub+"=" + Math.round(xMean[i]*1000)/1000+"       Y"+tSub+"="+Math.round(yMean[i]*1000)/1000;
			node.classList.add("white-cell");
			}
        }
      }
      
      function submitP(){
        window.location.href = 'bounds_calc4.html';
      }

        
    </script>
  </body>
</html>



