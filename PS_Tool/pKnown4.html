<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculate bounds for the effects of the treatment for in strata of interest</title>
    <link rel="stylesheet" href="css/foundation.min.css">
    <link rel="stylesheet" href="css/app.css">
    <script src="js/mathjs-master/dist/math.js"></script>
  </head>
  <body>
    
    <div class="callout large primary">
      <div class="row column text-center">
        <h1>Principal Stratification Tool</h1>
      </div>
    </div>
    
    <div class="row" id="content">

      <div class="medium-3 medium-offset-1 columns" data-sticky-container>
        <div class="sticky" data-sticky data-anchor="content">
          <ol class="menu vertical">
            <li><a href="index.html"><strong>Start &rarr;</strong> Calculating Bounds for Principal Causal Effects: Interactive Analysis Tool</a></li>
            <li><a href="intro_1a.html">Design Requirements</a></li>
			<li><a href="PS_tool.html"> Identify the Principal Strata for your Study</a></li>
			<li><a href="exclusions_4.html">Use Substantive Assumptions to Restrict the Number of Strata of Interest for these Analyses</a></li>
            <li class="active"><a href="pKnown4.html"> Determining Proportions of Subgroups using Observed Quantities</a></li>
            <li><!-- pUnknown.html -->Solving for Proportions that are not Directly Observed</li>
            <li><!-- meansIntro.html -->Solving for Means under Treatment and Control</li>
			<li><!-- means.html -->Applying the Exclusion Restriction</li>
			<li><!-- meansUnknown.html -->Solving for the Remaining Means</li>
            <li><!-- bounds_calc.html -->Calculating the Bounds and Estimating Ranges of Impact</li>
            <li><!-- NextSteps.html -->Next Steps</li>
          </ol>
        </div>
      </div>

      <div class="medium-7 columns">

      <h2>Determining proportions of subgroups using observed quantities</h2>

      <p id="instructions"> </p>
      
      <p id="instructions2"> </p>
		<p> This application assumes that there is not an imbalance in attrition between the treatment and control conditions, as high differential can bias results. Please see the <a href="https://ies.ed.gov/ncee/wwc/Docs/referenceresources/wwc_brief_attrition_080715.pdf" target="_blank" alt="WWC">WWC Attrition Standards</a> for more information.</p>
      
      <h3 id="heading1"> </h3>

      <div class="row">
        <div class="medium-8 small-6 columns">
          <label for="TtoT" id="q1"></label>
        </div>
        <div class="medium-4 small-6 columns">
          <div class="input-group">
            <input type="text" id="TtoT" placeholder="P=" class="input-group-field">
            <span class="input-group-label input-group-label-right">%</span>
          </div>
        </div>
      </div>
      

      <div class="row">
        <div class="medium-8 small-6 columns">
          <label for="TtoSub1" id="q2"></label>
        </div>
        <div class="medium-4 small-6 columns">
          <div class="input-group">
            <input type="text" id="TtoSub1" placeholder="P=" class="input-group-field">
            <span class="input-group-label input-group-label-right">%</span>
          </div>
        </div>
      </div>


      <div class="row">
        <div class="medium-8 small-6 columns">
          <label for="TtoSub1" id="q3"></label>
        </div>
        <div class="medium-4 small-6 columns">
          <div class="input-group">
            <input type="text" id="TtoSub2" placeholder="P=" class="input-group-field">
            <span class="input-group-label input-group-label-right">%</span>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="medium-8 small-6 columns">
          <label for="TtoSub1" id="q4"></label>
        </div>
        <div class="medium-4 small-6 columns">
          <div class="input-group">
            <input type="text" id="TtoSub3" placeholder="P=" class="input-group-field">
            <span class="input-group-label input-group-label-right">%</span>
          </div>
        </div>
      </div>
	  
      <h3 id="heading2"> </h3>

      <div class="row">
        <div class="medium-8 small-6 columns">
          <label for="CtoT" id="q5"></label>
        </div>
        <div class="medium-4 small-6 columns">
          <div class="input-group">
            <input type="text" id="CtoT" placeholder="P=" class="input-group-field">
            <span class="input-group-label input-group-label-right">%</span>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="medium-8 small-6 columns">
          <label for="CtoSub1" id="q6"></label>
        </div>
        <div class="medium-4 small-6 columns">
          <div class="input-group">
            <input type="text" id="CtoSub1" placeholder="P=" class="input-group-field">
            <span class="input-group-label input-group-label-right">%</span>
          </div>
        </div>
      </div>


      <div class="row">
        <div class="medium-8 small-6 columns">
          <label for="CtoSub1" id="q7"></label>
        </div>
        <div class="medium-4 small-6 columns">
          <div class="input-group">
            <input type="text" id="CtoSub2" placeholder="P=" class="input-group-field">
            <span class="input-group-label input-group-label-right">%</span>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="medium-8 small-6 columns">
          <label for="CtoSub1" id="q8"></label>
        </div>
        <div class="medium-4 small-6 columns">
          <div class="input-group">
            <input type="text" id="CtoSub3" placeholder="P=" class="input-group-field">
            <span class="input-group-label input-group-label-right">%</span>
          </div>
        </div>
      </div>

        <div class="row">
            <div class="small-12 text-center">
              <button class="button" onclick="submitP()">Continue</button>
            </div>
        </div>


        <p id="tableInfo" align="Left" style="font-size: 15px"> </p>   

        <table id="boundsGrid" class="testgrid" align="center">
        <tr>
          <th colspan=5  class="control-treatment-header" id="group1Name"></th>
        </tr>
        <tr>
          <th rowspan=6 class="control-treatment-header" id="group2Name"></th>
        </tr>
        <tr>
          <th> </th>
          <th id="strata1Name"></th>
          <th id="strata2Name"></th>
          <th id="strata3Name"></th>
		  <th id="strata4Name"></th>
        </tr>
        <tr>
          <th id="strata1Name2"></th>
          <td id="strata1Input"> </td>
          <td id="strata2Input"> </td>
          <td id="strata3Input"> </td>
          <td id="strata4Input"> </td>
        </tr>
        <tr>
          <th id="strata2Name2"></th>
          <td id="strata5Input"> </td>
          <td id="strata6Input"> </td>
          <td id="strata7Input"> </td>
          <td id="strata8Input"> </td>
        </tr>
        <tr>
          <th id="strata3Name2"></th>
          <td id="strata9Input"> </td>
          <td id="strata10Input"> </td>
          <td id="strata11Input"> </td>
          <td id="strata12Input"> </td>
        </tr>
        <tr>
          <th id="strata4Name2"></th>
          <td id="strata13Input"> </td>
          <td id="strata14Input"> </td>
          <td id="strata15Input"> </td>
          <td id="strata16Input"> </td>
        </tr>
      </table>



      <div class="row">
        <div class="small-12 text-center">
          <button class="button" onclick="cont()">Continue</button>
        </div>
      </div>  

      </div> <!--/ end medium- 7-->

      
      

      <div class="medium-1 columns">&nbsp;
      </div>

    </div><!--/ end row -->
    

    <footer>
      <div class="row expanded callout secondary">
        <div class="medium-10 medium-offset-1 columns">
          <p>Funding for this project was provided by Grant #201500035 from the Spencer Foundation. This website is designed to assist researchers interested in applying a principal stratification approach to their research questions. This tool intended for researchers who have a familiarity with the principal stratification approach. Researchers unfamiliar with the approach are encouraged to consult Page et al 2015 before using this tool.</p>
<br><p>Furey, J., Grindal, T., & Page, L. (2017). Calculating Bounds for Principal Causal Effects: Interactive Analysis Tool (Version 1.0, Software]. Available from <a> www.INSERTPAGE<a>  <p>

        </div>
      </div>


    </footer>
    
    <script src="js/vendor/jquery-2.1.4.min.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <script>

window.onload = function() {
        var groupNames= new Array();
        var strataNames = new Array();
        var group1 = localStorage.group1Local;
        var group2 = localStorage.group2Local;
        var strata = localStorage.strataLocal;
        strata = strata*strata;
        var strata1 = localStorage.strata1Local;
        var strata2 = localStorage.strata2Local;
        var strata3 = localStorage.strata3Local;
        var strata4 = localStorage.strata4Local;
        var cell1Input = localStorage.cell1;
        var cell2Input = localStorage.cell2;
        var cell3Input = localStorage.cell3;
        var cell4Input = localStorage.cell4;
        var cell5Input = localStorage.cell5;
        var cell6Input = localStorage.cell6;
        var cell7Input = localStorage.cell7;
        var cell8Input = localStorage.cell8;
        var cell9Input = localStorage.cell9;
        var cell10Input = localStorage.cell10;
        var cell11Input = localStorage.cell11;
        var cell12Input = localStorage.cell12;
        var cell13Input = localStorage.cell13;
        var cell14Input = localStorage.cell14;
        var cell15Input = localStorage.cell15;
        var cell16Input = localStorage.cell16;
        var outcome = localStorage.outcome;
        document.getElementById('heading1').innerHTML = "Enter the percentages of "+group1+"-assigned participants who took up each condition (Note: These percentages should sum to 100)";
        document.getElementById('q1').innerHTML = "What percentage of "+group1+" assigned participants took up the "+strata1+"?";
        document.getElementById('q2').innerHTML = "What percentage of "+group1+" assigned participants took up the "+strata2+"?";
        document.getElementById('q3').innerHTML = "What percentage of "+group1+" assigned participants took up the "+strata3+"?";
        document.getElementById('q4').innerHTML = "What percentage of "+group1+" assigned participants took up the "+strata4+"?";
        document.getElementById('heading2').innerHTML = "Enter the percentages of "+group2+"-assigned participants who took up each condition (Note: These percentages should sum to 100)";
        document.getElementById('q5').innerHTML = "What percentage of "+group2+" assigned participants took up the "+strata1+"?";
        document.getElementById('q6').innerHTML = "What percentage of "+group2+" assigned participants took up the "+strata2+"?";
        document.getElementById('q7').innerHTML = "What percentage of "+group2+" assigned participants took up the "+strata3+"?";
        document.getElementById('q8').innerHTML = "What percentage of "+group2+" assigned participants took up the "+strata4+"?";
        document.getElementById('strata1Input').innerHTML = cell1Input;
        document.getElementById('strata2Input').innerHTML = cell2Input;
        document.getElementById('strata3Input').innerHTML = cell3Input;
        document.getElementById('strata4Input').innerHTML = cell4Input;
        document.getElementById('strata5Input').innerHTML = cell5Input;
        document.getElementById('strata6Input').innerHTML = cell6Input;
        document.getElementById('strata7Input').innerHTML = cell7Input;
        document.getElementById('strata8Input').innerHTML = cell8Input;
        document.getElementById('strata9Input').innerHTML = cell9Input;
        document.getElementById('strata10Input').innerHTML = cell10Input;
        document.getElementById('strata11Input').innerHTML = cell11Input;
        document.getElementById('strata12Input').innerHTML = cell12Input;
        document.getElementById('strata13Input').innerHTML = cell13Input;
        document.getElementById('strata14Input').innerHTML = cell14Input;
        document.getElementById('strata15Input').innerHTML = cell15Input;
        document.getElementById('strata16Input').innerHTML = cell16Input;
        document.getElementById('strata1Name').innerHTML = strata1;
        document.getElementById('strata2Name').innerHTML = strata2;
        document.getElementById('strata3Name').innerHTML = strata3;
        document.getElementById('strata4Name').innerHTML = strata4;
        document.getElementById('strata1Name2').innerHTML = strata1;
        document.getElementById('strata2Name2').innerHTML = strata2;
        document.getElementById('strata3Name2').innerHTML = strata3;
        document.getElementById('strata4Name2').innerHTML = strata4;
        document.getElementById('group1Name').innerHTML = "Assigned to "+group1;
        document.getElementById('group2Name').innerHTML = "Assigned to "+group2;
        document.getElementById('instructions').innerHTML = "Below please enter the proportions of "+group1+" and "+group2+"-assigned participants who were observed in "+strata1+", "+strata2+", "+strata3+" or "+strata4+".  The tool will use these proportions to estimate the share of participants in each of the groups represented in each of your strata of interest.";
        document.getElementById('instructions2').innerHTML = "Please limit your sample to participants that are not missing "+outcome;
        //gray out excluded cells
        var allCells = document.getElementsByTagName("td");
        for(var i = 0; i < strata; i++) {
          var node = allCells[i];
          var cellContent = node.childNodes[0].nodeValue; 
          //check for 'one' and assign this table cell's background color accordingly 
          if (cellContent === "Monotonicity Assumption")
            node.classList.add("gray-cell");
          if (cellContent == "Irrelevant Alternative")
            node.classList.add("gray-cell");
        }
        
        document.getElementById('strata1Input').innerHTML = "";
        document.getElementById('strata2Input').innerHTML = "";
        document.getElementById('strata3Input').innerHTML = "";
        document.getElementById('strata4Input').innerHTML = "";
        document.getElementById('strata5Input').innerHTML = "";
        document.getElementById('strata6Input').innerHTML = "";
        document.getElementById('strata7Input').innerHTML = "";
        document.getElementById('strata8Input').innerHTML = "";
        document.getElementById('strata9Input').innerHTML = "";
        document.getElementById('strata10Input').innerHTML = "";
        document.getElementById('strata11Input').innerHTML = "";
        document.getElementById('strata12Input').innerHTML = "";
        document.getElementById('strata13Input').innerHTML = "";
        document.getElementById('strata14Input').innerHTML = "";
        document.getElementById('strata15Input').innerHTML = "";
        document.getElementById('strata16Input').innerHTML = "";		
      }

  function removeArray(array,element){
    for(var i = array.length; i--;){
      if (array[i] === element) 
		array.splice(i, 1);
    }
    }
        
  function submitP(){
    var group1 = localStorage.group1Local;
    var group2 = localStorage.group2Local;
    var strata1 = localStorage.strata1Local;
    var strata2 = localStorage.strata2Local;
    var strata3 = localStorage.strata3Local;
    var strata4 = localStorage.strata4Local;
    var isActive1 = parseInt(localStorage.isActive1);
    var isActive2 = parseInt(localStorage.isActive2);
    var isActive3 = parseInt(localStorage.isActive3);
    var isActive4 = parseInt(localStorage.isActive4);
    var isActive5 = parseInt(localStorage.isActive5);
    var isActive6 = parseInt(localStorage.isActive6);
    var isActive7 = parseInt(localStorage.isActive7);
    var isActive8 = parseInt(localStorage.isActive8);
    var isActive9 = parseInt(localStorage.isActive9);
    var isActive10 = parseInt(localStorage.isActive10);
    var isActive11 = parseInt(localStorage.isActive11);
    var isActive12 = parseInt(localStorage.isActive12);
    var isActive13 = parseInt(localStorage.isActive13);
    var isActive14 = parseInt(localStorage.isActive14);
    var isActive15 = parseInt(localStorage.isActive15);
    var isActive16 = parseInt(localStorage.isActive16);
    var isActive = [isActive1, isActive2, isActive3, isActive4, isActive5, isActive6, isActive7, isActive8, isActive9, isActive10, isActive11, isActive12, isActive13, isActive14, isActive15, isActive16];
    var isActiveBaseline = [isActive1, isActive2, isActive3, isActive4, isActive5, isActive6, isActive7, isActive8, isActive9, isActive10, isActive11, isActive12, isActive13, isActive14, isActive15, isActive16];
    var pMean = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    var countRow1 = localStorage.countRow1;
    var countRow2 = localStorage.countRow2;
    var countRow3 = localStorage.countRow3;
    var countRow4 = localStorage.countRow4;
    var countColumn1 = localStorage.countColumn1;
    var countColumn2 = localStorage.countColumn2;
    var countColumn3 = localStorage.countColumn3;
    var countColumn4 = localStorage.countColumn4;
    var TtoT = document.getElementById("TtoT").value;
    var TtoSub1 = document.getElementById("TtoSub1").value;
    var TtoSub2 = document.getElementById("TtoSub2").value;
	var TtoSub3 = document.getElementById("TtoSub3").value;
    var CtoT = document.getElementById("CtoT").value;
    var CtoSub1 = document.getElementById("CtoSub1").value;
    var CtoSub2 = document.getElementById("CtoSub2").value;
	var CtoSub3 = document.getElementById("CtoSub3").value;
    var TtoTNum= Number(TtoT);
    var TtoSub1Num = Number(TtoSub1);
    var TtoSub2Num = Number(TtoSub2);
	var TtoSub3Num = Number(TtoSub3);
    var CtoTNum= Number(CtoT);
    var CtoSub1Num = Number(CtoSub1);
    var CtoSub2Num = Number(CtoSub2); 
	var CtoSub3Num = Number(CtoSub3);
    var sumT = TtoTNum + TtoSub1Num + TtoSub2Num + TtoSub3Num;
    var sumC = CtoTNum + CtoSub1Num + CtoSub2Num + CtoSub3Num;
    if (sumT==100){
      TtoTNum = TtoTNum/100;
      TtoSub1Num = TtoSub1Num/100;
      TtoSub2Num = TtoSub2Num/100;
      TtoSub3Num = TtoSub3Num/100;
    }
    if (sumC==100){
      CtoTNum = CtoTNum/100;
      CtoSub1Num = CtoSub1Num/100;
      CtoSub2Num = CtoSub2Num/100;
      CtoSub3Num = CtoSub3Num/100;
    }
    sumT = TtoTNum + TtoSub1Num + TtoSub2Num + TtoSub3Num;
    sumC = CtoTNum + CtoSub1Num + CtoSub2Num + CtoSub3Num;
    if (sumT !=1 || sumC!=1){alert("Your proportions do not add up to 100, please fix this and then re-submit.");}
    if(sumT==1 & sumC==1){
    document.getElementById('strata1Name').innerHTML = localStorage.strata1Local + " (P=" + TtoTNum + ")";
    document.getElementById('strata2Name').innerHTML = localStorage.strata2Local + " (P=" + TtoSub1Num + ")";
    document.getElementById('strata3Name').innerHTML = localStorage.strata3Local + " (P=" + TtoSub2Num + ")";
    document.getElementById('strata4Name').innerHTML = localStorage.strata3Local + " (P=" + TtoSub3Num + ")";
    document.getElementById('strata1Name2').innerHTML = localStorage.strata1Local + " (P=" + CtoTNum + ")";
    document.getElementById('strata2Name2').innerHTML = localStorage.strata2Local + " (P=" + CtoSub1Num + ")";
    document.getElementById('strata3Name2').innerHTML = localStorage.strata3Local + " (P=" + CtoSub2Num + ")";
    document.getElementById('strata4Name2').innerHTML = localStorage.strata3Local + " (P=" + CtoSub3Num + ")";
    }
    
    var cellsLocalRow1 = [localStorage.cell1, localStorage.cell2, localStorage.cell3, localStorage.cell4];
    var cellsLocalRow2 = [localStorage.cell5, localStorage.cell6, localStorage.cell7, localStorage.cell8];
    var cellsLocalRow3 = [localStorage.cell9, localStorage.cell10, localStorage.cell11, localStorage.cell12];
    var cellsLocalRow4 = [localStorage.cell13, localStorage.cell14, localStorage.cell15, localStorage.cell16];
    var cellsLocalColumn1 = [localStorage.cell1, localStorage.cell5, localStorage.cell9, localStorage.cell13];
    var cellsLocalColumn2 = [localStorage.cell2, localStorage.cell6, localStorage.cell10, localStorage.cell14];
    var cellsLocalColumn3 = [localStorage.cell3, localStorage.cell7, localStorage.cell11, localStorage.cell15];
	var cellsLocalColumn4 = [localStorage.cell4, localStorage.cell8, localStorage.cell12, localStorage.cell16];
    var ticker = 1;
    var pHeadings = [CtoTNum, CtoSub1Num, CtoSub2Num, CtoSub3Num, TtoTNum, TtoSub1Num, TtoSub2Num, TtoSub3Num];
    var rcCounts = [countRow1,countRow2,countRow3,countRow4,countColumn1,countColumn2,countColumn3,countColumn4];
    
    var pMeanTrack=[];
    var pMeanKnown=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    
    var group = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];
    var subgroupsREF = [strata1, strata2, strata3, strata4];
    var groupsKNOWN = [];
    var subgroupsKNOWN = [];
    var pForTextKNOWN = [];
    
    for(i=0; i<4; i++) {
      if(rcCounts[0]==1 & isActive[i]==1){
      pMeanKnown[i]=pHeadings[0];
      groupsKNOWN.push(group2);
      subgroupsKNOWN.push(subgroupsREF[i]);
      pForTextKNOWN.push(Math.round(parseFloat(pHeadings[0])*10000)/100);
      }
    }
    for(i=4; i<8; i++) {
      if(rcCounts[1]==1 & isActive[i]==1){
      pMeanKnown[i]=pHeadings[1];
      groupsKNOWN.push(group2);
      subgroupsKNOWN.push(subgroupsREF[i-4]);
      pForTextKNOWN.push(Math.round(parseFloat(pHeadings[1])*10000)/100);
      }
    }
    for(i=8; i<12; i++) {
      if(rcCounts[2]==1 & isActive[i]==1){
      pMeanKnown[i]=pHeadings[2];
      groupsKNOWN.push(group2);
      subgroupsKNOWN.push(subgroupsREF[i-8]);
      pForTextKNOWN.push(Math.round(parseFloat(pHeadings[2])*10000)/100);
      }
    }
    for(i=12; i<16; i++) {
      if(rcCounts[3]==1 & isActive[i]==1){
      pMeanKnown[i]=pHeadings[3];
      groupsKNOWN.push(group2);
      subgroupsKNOWN.push(subgroupsREF[i-12]);
      pForTextKNOWN.push(Math.round(parseFloat(pHeadings[3])*10000)/100);
      }
    }	
    var column1Nums = [0,4,8,12];
    for(i=0; i<4; i++) {
      if(rcCounts[4]==1 & isActive[column1Nums[i]]==1){
      pMeanKnown[column1Nums[i]]=pHeadings[4];
      groupsKNOWN.push(group1);
      subgroupsKNOWN.push(subgroupsREF[i]);
      pForTextKNOWN.push(Math.round(parseFloat(pHeadings[4])*10000)/100);
      }
    }
    
    var column2Nums = [1,5,9,13];
    for(i=0; i<4; i++) {
      if(rcCounts[5]==1 & isActive[column2Nums[i]]==1){
      pMeanKnown[column2Nums[i]]=pHeadings[5];
      groupsKNOWN.push(group1);
      subgroupsKNOWN.push(subgroupsREF[i]);
      pForTextKNOWN.push(Math.round(parseFloat(pHeadings[5])*10000)/100);
      }
    }
    
    var column3Nums = [2,6,10,14];
    for(i=0; i<4; i++) {
      if(rcCounts[6]==1 & isActive[column3Nums[i]]==1){
      pMeanKnown[column3Nums[i]]=pHeadings[6];
      groupsKNOWN.push(group1);
      subgroupsKNOWN.push(subgroupsREF[i]);
      pForTextKNOWN.push(Math.round(parseFloat(pHeadings[6])*10000)/100);
      }
    }
	
    var column4Nums = [3,7,11,15];
    for(i=0; i<4; i++) {
      if(rcCounts[7]==1 & isActive[column4Nums[i]]==1){
      pMeanKnown[column4Nums[i]]=pHeadings[7];
      groupsKNOWN.push(group1);
      subgroupsKNOWN.push(subgroupsREF[i]);
      pForTextKNOWN.push(Math.round(parseFloat(pHeadings[7])*10000)/100);
      }
    }
    
    var groups = [];
    var subgroups = []; 
    var pForText = [];
    while(ticker>0)
    {
    ticker = 0;
    for(i=0; i<4; i++) {
      if(rcCounts[0]==1 & isActive[i]==1){
      pMean[i]=pHeadings[0];
      ticker = ticker + 1;
      isActive[i]=0;
      rcCounts[0]=0;
      pHeadings[i+4] = Math.abs(pHeadings[i+4] - pHeadings[0]);
      rcCounts[i+4] = rcCounts[i+4]-1;
      groups.unshift(group2);
      subgroups.unshift(subgroupsREF[i]);
      pForText.unshift(parseFloat(pHeadings[0]*10000)/100);
      }
    }
    for(i=4; i<8; i++) {
      if(rcCounts[1]==1 & isActive[i]==1){
      pMean[i]=pHeadings[1];
      ticker = ticker + 1;
      isActive[i]=0;
      rcCounts[1]=0;
      pHeadings[i] = Math.abs(pHeadings[i] - pHeadings[1]);
      rcCounts[i]=rcCounts[i]-1;
      groups.unshift(group2);
      subgroups.unshift(subgroupsREF[i-4]);
      pForText.unshift(parseFloat(pHeadings[1]*10000)/100);

      }
    }
    for(i=8; i<12; i++) {
      if(rcCounts[2]==1 & isActive[i]==1){
      pMean[i]=pHeadings[2];
      ticker = ticker + 1;
      isActive[i]=0;
      rcCounts[2]=0;
      pHeadings[i-4] = Math.abs(pHeadings[i-4] - pHeadings[2]);
      rcCounts[i-4]=rcCounts[i-4]-1;
      groups.unshift(group2);
      subgroups.unshift(subgroupsREF[i-8]);
      pForText.unshift(parseFloat(pHeadings[2]*10000)/100);

      }
    }
    
    for(i=12; i<16; i++) {
      if(rcCounts[3]==1 & isActive[i]==1){
      pMean[i]=pHeadings[3];
      ticker = ticker + 1;
      isActive[i]=0;
      rcCounts[3]=0;
      pHeadings[i-8] = Math.abs(pHeadings[i-8] - pHeadings[3]);
      rcCounts[i-8]=rcCounts[i-8]-1;
      groups.unshift(group2);
      subgroups.unshift(subgroupsREF[i-12]);
      pForText.unshift(parseFloat(pHeadings[3]*10000)/100);

      }
    }
	
    var column1Nums = [0,4,8,12];
    for(i=0; i<4; i++) {
      if(rcCounts[4]==1 & isActive[column1Nums[i]]==1){
      pMean[column1Nums[i]]=pHeadings[4];
      ticker = ticker + 1;
      isActive[column1Nums[i]]=0;
      rcCounts[4]=0
      pHeadings[i]=Math.abs(pHeadings[i]-pHeadings[4]);
      rcCounts[i]=rcCounts[i]-1;
      groups.unshift(group1);
      subgroups.unshift(subgroupsREF[i]);
      pForText.unshift(parseFloat(pHeadings[4]*10000)/100);

      }
    }
    
    var column2Nums = [1,5,9,13];
    for(i=0; i<4; i++) {
      if(rcCounts[5]==1 & isActive[column2Nums[i]]==1){
      pMean[column2Nums[i]]=pHeadings[5];
      ticker = ticker + 1;
      isActive[column2Nums[i]]=0;
      rcCounts[5]=0
      pHeadings[i]=Math.abs(pHeadings[i]-pHeadings[5]);
      rcCounts[i]=rcCounts[i]-1;
      groups.unshift(group1);
      subgroups.unshift(subgroupsREF[i]);
      pForText.unshift(parseFloat(pHeadings[5]*10000)/100);

      }
    }
    
    var column3Nums = [2,6,10,14];
    for(i=0; i<4; i++) {
      if(rcCounts[6]==1 & isActive[column3Nums[i]]==1){
      pMean[column3Nums[i]]=pHeadings[6];
      ticker = ticker + 1;
      isActive[column3Nums[i]]=0;
      rcCounts[6]=0
      pHeadings[i]=Math.abs(pHeadings[i]-pHeadings[6]);
      rcCounts[i]=rcCounts[i]-1;
      groups.unshift(group1);
      subgroups.unshift(subgroupsREF[i]);
      pForText.unshift(parseFloat(pHeadings[6]*10000)/100);

      }
    }

    var column4Nums = [3,7,11,15];
    for(i=0; i<4; i++) {
      if(rcCounts[7]==1 & isActive[column4Nums[i]]==1){
      pMean[column4Nums[i]]=pHeadings[7];
      ticker = ticker + 1;
      isActive[column4Nums[i]]=0;
      rcCounts[7]=0
      pHeadings[i]=Math.abs(pHeadings[i]-pHeadings[7]);
      rcCounts[i]=rcCounts[i]-1;
      groups.unshift(group1);
      subgroups.unshift(subgroupsREF[i]);
      pForText.unshift(parseFloat(pHeadings[7]*10000)/100);

      }
    }
    }

    
    var stillActive = 0;
    for(i=0; i<16; i++) {
    if(isActive[i] == 1) {stillActive = stillActive + 1;}
    }
    
    if(pMeanKnown[0]!=0)
    {
      document.getElementById('strata1Input').innerHTML = "P=" + pMeanKnown[0];
      document.getElementById("strata1Input").classList.add("blue-cell");
    }

    if(pMeanKnown[1]!=0)
    {
      document.getElementById('strata2Input').innerHTML = "P=" + pMeanKnown[1];
      document.getElementById("strata2Input").classList.add("blue-cell");
    }
    
    if(pMeanKnown[2]!=0)
    {
      document.getElementById('strata3Input').innerHTML = "P=" + pMeanKnown[2];
      document.getElementById("strata3Input").classList.add("blue-cell");
    }
    
    if(pMeanKnown[3]!=0)
    {
      document.getElementById('strata4Input').innerHTML = "P=" + pMeanKnown[3];
      document.getElementById("strata4Input").classList.add("blue-cell");
    }

    if(pMeanKnown[4]!=0)
    {
      document.getElementById('strata5Input').innerHTML = "P=" + pMeanKnown[4];
      document.getElementById("strata5Input").classList.add("blue-cell");
    }
    
    if(pMeanKnown[5]!=0)
    {
      document.getElementById('strata6Input').innerHTML = "P=" + pMeanKnown[5];
      document.getElementById("strata6Input").classList.add("blue-cell");
    }

    if(pMeanKnown[6]!=0)
    {
      document.getElementById('strata7Input').innerHTML = "P=" + pMeanKnown[6];
      document.getElementById("strata7Input").classList.add("blue-cell");
    }

    if(pMeanKnown[7]!=0)
    {
      document.getElementById('strata8Input').innerHTML = "P=" + pMeanKnown[7];
      document.getElementById("strata8Input").classList.add("blue-cell");
    }
    
    if(pMeanKnown[8]!=0)
    {
      document.getElementById('strata9Input').innerHTML = "P=" + pMeanKnown[8];
      document.getElementById("strata9Input").classList.add("blue-cell");
    }
	
    if(pMeanKnown[9]!=0)
    {
      document.getElementById('strata10Input').innerHTML = "P=" + pMeanKnown[9];
      document.getElementById("strata10Input").classList.add("blue-cell");
    }
	
    if(pMeanKnown[10]!=0)
    {
      document.getElementById('strata11Input').innerHTML = "P=" + pMeanKnown[10];
      document.getElementById("strata11Input").classList.add("blue-cell");
    }

    if(pMeanKnown[11]!=0)
    {
      document.getElementById('strata12Input').innerHTML = "P=" + pMeanKnown[11];
      document.getElementById("strata12Input").classList.add("blue-cell");
    }
    
    if(pMeanKnown[12]!=0)
    {
      document.getElementById('strata13Input').innerHTML = "P=" + pMeanKnown[12];
      document.getElementById("strata13Input").classList.add("blue-cell");
    }
    
    if(pMeanKnown[13]!=0)
    {
      document.getElementById('strata14Input').innerHTML = "P=" + pMeanKnown[13];
      document.getElementById("strata14Input").classList.add("blue-cell");
    }

    if(pMeanKnown[14]!=0)
    {
      document.getElementById('strata15Input').innerHTML = "P=" + pMeanKnown[14];
      document.getElementById("strata15Input").classList.add("blue-cell");
    }
    
    if(pMeanKnown[15]!=0)
    {
      document.getElementById('strata16Input').innerHTML = "P=" + pMeanKnown[15];
      document.getElementById("strata16Input").classList.add("blue-cell");
    }
    
  localStorage.countRow1 = countRow1;
  localStorage.countRow2 = countRow2;
  localStorage.countRow3 = countRow3;
  localStorage.countRow4 = countRow4;
  localStorage.countColumn1 = countColumn1;
  localStorage.countColumn2 = countColumn2;
  localStorage.countColumn3 = countColumn3;
  localStorage.countColumn4 = countColumn4;
  localStorage.isActive1 = isActiveBaseline[0];
  localStorage.isActive2 = isActiveBaseline[1];
  localStorage.isActive3 = isActiveBaseline[2];
  localStorage.isActive4 = isActiveBaseline[3];
  localStorage.isActive5 = isActiveBaseline[4];
  localStorage.isActive6 = isActiveBaseline[5];
  localStorage.isActive7 = isActiveBaseline[6];
  localStorage.isActive8 = isActiveBaseline[7];
  localStorage.isActive9 = isActiveBaseline[8];
  localStorage.isActive10 = isActiveBaseline[9];
  localStorage.isActive11 = isActiveBaseline[10];
  localStorage.isActive12 = isActiveBaseline[11];
  localStorage.isActive13 = isActiveBaseline[12];
  localStorage.isActive14 = isActiveBaseline[13];
  localStorage.isActive15 = isActiveBaseline[14];
  localStorage.isActive16 = isActiveBaseline[15];
  localStorage.TtoTNum = TtoTNum;
  localStorage.TtoSub1Num = TtoSub1Num;
  localStorage.TtoSub2Num = TtoSub2Num;
  localStorage.TtoSub3Num = TtoSub3Num;
  localStorage.CtoTNum = CtoTNum;
  localStorage.CtoSub1Num = CtoSub1Num;
  localStorage.CtoSub2Num = CtoSub2Num;
  localStorage.CtoSub3Num = CtoSub3Num;
  localStorage.pMeanKnown1 = pMeanKnown[0];
  localStorage.pMeanKnown2 = pMeanKnown[1];
  localStorage.pMeanKnown3 = pMeanKnown[2];
  localStorage.pMeanKnown4 = pMeanKnown[3];
  localStorage.pMeanKnown5 = pMeanKnown[4];
  localStorage.pMeanKnown6 = pMeanKnown[5];
  localStorage.pMeanKnown7 = pMeanKnown[6];
  localStorage.pMeanKnown8 = pMeanKnown[7];
  localStorage.pMeanKnown9 = pMeanKnown[8];
  localStorage.pMeanKnown10 = pMeanKnown[9];
  localStorage.pMeanKnown11 = pMeanKnown[10];
  localStorage.pMeanKnown12 = pMeanKnown[11];
  localStorage.pMeanKnown13 = pMeanKnown[12];
  localStorage.pMeanKnown14 = pMeanKnown[13];
  localStorage.pMeanKnown15 = pMeanKnown[14];
  localStorage.pMeanKnown16 = pMeanKnown[15];
  localStorage.pMean1 = pMean[0];
  localStorage.pMean2 = pMean[1];
  localStorage.pMean3 = pMean[2];
  localStorage.pMean4 = pMean[3];
  localStorage.pMean5 = pMean[4];
  localStorage.pMean6 = pMean[5];
  localStorage.pMean7 = pMean[6];
  localStorage.pMean8 = pMean[7];
  localStorage.pMean9 = pMean[8];
  localStorage.pMean10 = pMean[9]; 
  localStorage.pMean11 = pMean[10];
  localStorage.pMean12 = pMean[11];
  localStorage.pMean13 = pMean[12];
  localStorage.pMean14 = pMean[13];
  localStorage.pMean15 = pMean[14];
  localStorage.pMean16 = pMean[15];  
  var knownCount = 0;
  var tableInfoKnown = "";
  var lenghtminus1 = groupsKNOWN.length - 1;
  for(i=0; i<groupsKNOWN.length; i++)
  {
    if(i<lenghtminus1){tableInfoKnown = tableInfoKnown + Math.round(pForTextKNOWN[i]) + "% of your " + groupsKNOWN[i] + " participants took up " + subgroupsKNOWN[i] + ", ";}
    if(i==lenghtminus1){tableInfoKnown = tableInfoKnown + "and " + Math.round(pForTextKNOWN[i]) + "% of your " + groupsKNOWN[i] + " participants took up " + subgroupsKNOWN[i] + ".";}
  }
  document.getElementById('tableInfo').innerHTML = "Below, you can see the grid representing possible principal strata based on your study specific conditions. Participants can be assigned to "+group1+" or "+group2+" and take up "+strata1+", "+strata2+", "+strata3+", or "+strata4+". Based on "+group1+" and "+group2+" group specific values you have entered, you can use this information to determine the share of individuals in certain strata. "+tableInfoKnown+" Participants in directly observed cells exhibit the same behavior under both treatment assignments. For example, we would expect control-assigned participants who took up treatment to also take up treatment when actually assigned to that condition. We would also assume that a participant who was assigned to treatment but took up an alternate condition would also take up an alternate condition under assignment to control.";
  var tableInfoUnknown = pForText[0] + "% of your " + groups[0] + " participants took up " + subgroups[i];
  localStorage.tableInfo = tableInfoUnknown;
  } 
  function cont(){
  window.location.href = 'pUnknown4.html';
  }

        
    </script>
  </body>
</html>



