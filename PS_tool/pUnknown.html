<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calculate bounds for the effects of the treatment for in strata of interest</title>
    <link rel="stylesheet" href="css/foundation.min.css">
    <link rel="stylesheet" href="css/app.css">
    <script src="js/mathjs-master/dist/math.js"></script>
  </head>
  <body>
    
    <!-- Start Top Bar -->
    <div class="top-bar">
      <div class="top-bar-left">
        <ul class="menu">
          <li class="menu-text">PS Tool</li>
        </ul>
      </div>
      <div class="top-bar-right">
        <ul class="menu">
          <li><a href="#">Menu 1</a></li>
          <li><a href="#">Menu 2</a></li>
          <li><a href="#">Menu 3</a></li>
          <li><a href="#">Menu 4</a></li>
        </ul>
      </div>
    </div>
    <!-- End Top Bar -->

    <div class="callout large primary">
      <div class="row column text-center">
        <h1>Principal Stratification Tool</h1>
      </div>
    </div>
    
    <div class="row" id="content">

      <div class="medium-2 medium-offset-1 columns" data-sticky-container>
        <div class="sticky" data-sticky data-anchor="content">
          <ol class="no-bullet">
            <li><a href="index.html">Start</a></li>
          </ol>
        </div>
      </div>

      <div class="medium-7 columns">
        <div class="row">
          <h2>Solving for Proportions that are not Directly Observed</h2>
          <p>Using the directly observable proportions, we can solve for the proportions of the remaining groups. For example, We know that x% of control students took up Condition 1 when assigned to control. We know that y% of treatment students took up Condition 1, even though they were assigned to treatment. Thus, the compliers who took up Condition 1 under control (and would take up the treatment condition under treatment) is w%.</p>

          <table id="boundsGrid" class="testgrid" align="center">
            <tr>
              <th colspan=5 style="font-size:15px" id="group1Name"></th>
            </tr>
            <tr>
              <th rowspan=6 style="font-size:15px" id="group2Name"></th>
            </tr>
            <tr>
              <th> </th>
              <th id="strata1Name"></th>
              <th id="strata2Name"></th>
              <th id="strata3Name"></th>
            </tr>
            <tr>
              <th id="strata1Name2"></th>
              <td id="strata1Input"> </td>
              <td id="strata2Input"> </td>
              <td id="strata3Input"> </td>
            </tr>
            <tr>
              <th id="strata2Name2"></th>
              <td id="strata4Input"> </td>
              <td id="strata5Input"> </td>
              <td id="strata6Input"> </td>
            </tr>
            <tr>
              <th id="strata3Name2"></th>
              <td id="strata7Input"> </td>
              <td id="strata8Input"> </td>
              <td id="strata9Input"> </td>
            </tr>
          </table>
        </div> <!--/ end blog post -->

        <div class="row">
            <div class="small-12 text-center">
              <button class="button" onclick="submitP()">Continue</button>
            </div>
        </div>

      </div> <!--/ end medium- 7-->

      
      

      <div class="medium-1 columns">&nbsp;
      </div>

    </div><!--/ end row -->
    

    <footer>
      <div class="row expanded callout secondary">
        <div class="medium-10 medium-offset-1 columns">
      <p>Funding for this project was provided through a grant from Spencer Foundation. This website is designed to assist researchers interested in applying a principal stratification approach to their research questions. This tool intended for researchers who have a familiarity with the principal stratification approach. Researchers unfamiliar with the approach are encouraged to consult <a href="https://gspp.berkeley.edu/assets/uploads/research/pdf/Principal_Stratification.pdf" target="_blank">Page <em>et al</em> 2015 </a>  before using this tool. </p>

        </div>
      </div>


      <!--<div class="row">
        <div class="medium-12 columns text-center">
          <p><strong>Funding for this project was provided through a grant from Spencer Foundation</strong></p>
        </div>
      </div>-->

    </footer>
    
    <script src="js/vendor/jquery-2.1.4.min.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <script>
      window.onload = function() {
        var groupNames= new Array();
        var strataNames = new Array();
        var group1 = localStorage.group1Local;
        var group2 = localStorage.group2Local;
        var strata = localStorage.strataLocal;
        strata = strata*strata;
        var strata1 = localStorage.strata1Local;
        var strata2 = localStorage.strata2Local;
        var strata3 = localStorage.strata3Local;
        var isActive1 = parseInt(localStorage.isActive1);
        var isActive2 = parseInt(localStorage.isActive2);
        var isActive3 = parseInt(localStorage.isActive3);
        var isActive4 = parseInt(localStorage.isActive4);
        var isActive5 = parseInt(localStorage.isActive5);
        var isActive6 = parseInt(localStorage.isActive6);
        var isActive7 = parseInt(localStorage.isActive7);
        var isActive8 = parseInt(localStorage.isActive8);
        var isActive9 = parseInt(localStorage.isActive9);
        var isActive = [isActive1, isActive2, isActive3, isActive4, isActive5, isActive6, isActive7, isActive8, isActive9];
        var pMeanKnown1 = localStorage.pMeanKnown1;
        var pMeanKnown2 = localStorage.pMeanKnown2;
        var pMeanKnown3 = localStorage.pMeanKnown3;
        var pMeanKnown4 = localStorage.pMeanKnown4;
        var pMeanKnown5 = localStorage.pMeanKnown5;
        var pMeanKnown6 = localStorage.pMeanKnown6;
        var pMeanKnown7 = localStorage.pMeanKnown7;
        var pMeanKnown8 = localStorage.pMeanKnown8;
        var pMeanKnown9 = localStorage.pMeanKnown9;
        var pMeanKnown = [pMeanKnown1, pMeanKnown2, pMeanKnown3, pMeanKnown4, pMeanKnown5, pMeanKnown6, pMeanKnown7, pMeanKnown8, pMeanKnown9];
        var pMean1 = localStorage.pMean1;
        var pMean2 = localStorage.pMean2;
        var pMean3 = localStorage.pMean3;
        var pMean4 = localStorage.pMean4;
        var pMean5 = localStorage.pMean5;
        var pMean6 = localStorage.pMean6;
        var pMean7 = localStorage.pMean7;
        var pMean8 = localStorage.pMean8;
        var pMean9 = localStorage.pMean9;
        var pMean = [pMean1, pMean2, pMean3, pMean4, pMean5, pMean6, pMean7, pMean8, pMean9];
        var TtoTNum = localStorage.TtoTNum;
        var TtoSub1Num = localStorage.TtoSub1Num;
        var TtoSub2Num = localStorage.TtoSub2Num;
        var CtoTNum = localStorage.CtoTNum;
        var CtoSub1Num = localStorage.CtoSub1Num;
        var CtoSub2Num = localStorage.CtoSub2Num;
        document.getElementById('strata1Name').innerHTML = localStorage.strata1Local + " (P=" + TtoTNum + ")";
        document.getElementById('strata2Name').innerHTML = localStorage.strata2Local + " (P=" + TtoSub1Num + ")";
        document.getElementById('strata3Name').innerHTML = localStorage.strata3Local + " (P=" + TtoSub2Num + ")";
        document.getElementById('strata1Name2').innerHTML = localStorage.strata1Local + " (P=" + CtoTNum + ")";
        document.getElementById('strata2Name2').innerHTML = localStorage.strata2Local + " (P=" + CtoSub1Num + ")";
        document.getElementById('strata3Name2').innerHTML = localStorage.strata3Local + " (P=" + CtoSub2Num + ")";
        document.getElementById('group1Name').innerHTML = group1;
        document.getElementById('group2Name').innerHTML = group2;
        //gray out excluded cells
        var allCells = document.getElementsByTagName("td");
        for(var i = 0; i < strata; i++) {
          var node = allCells[i];
          var cellContent = node.childNodes[0].nodeValue; 
          if (isActive[i]==0)
            node.style.backgroundColor = "#808080";
          if(isActive[i]!=0)
            node.innerHTML = "P="+ pMean[i].substring(0,4);
          if(pMeanKnown[i]==0 & pMean[i]!=0)
            node.style.backgroundColor = "#6495ED";

        }
      }
      
      function submitP(){
      window.location.href = 'means.html';
      }

        
    </script>
  </body>
</html>



