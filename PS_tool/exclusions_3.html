<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Use substantive assumptions to constraints the number of strata for this study</title>
    <link rel="stylesheet" href="css/foundation.min.css">
    <link rel="stylesheet" href="css/app.css">
  </head>
  <body>
    
    <!-- Start Top Bar -->
    <div class="top-bar">
      <div class="top-bar-left">
        <ul class="menu">
          <li class="menu-text">PS Tool</li>
        </ul>
      </div>
      <div class="top-bar-right">
        <ul class="menu">
          <li><a href="#">Menu 1</a></li>
          <li><a href="#">Menu 2</a></li>
          <li><a href="#">Menu 3</a></li>
          <li><a href="#">Menu 4</a></li>
        </ul>
      </div>
    </div>
    <!-- End Top Bar -->

    <div class="callout large primary">
      <div class="row column text-center">
        <h1>Principal Stratification Tool</h1>
      </div>
    </div>
    
    <div class="row" id="content">

      <div class="medium-2 medium-offset-1 columns" data-sticky-container>
        <div class="sticky" data-sticky data-anchor="content">
          <ol class="no-bullet">
            <li><a href="index.html">Start</a></li>
            <li><a href="PS_tool.html">&#8592; Back to Input</a>
          </ol>
        </div>
      </div>

      <div class="medium-7 columns">

          <h2>Use Substantive Assumptions to Constraints the Number of Strata for this Study</h2>
          
          <p>In most cases, it is possible to eliminate one or more of the strata based on two substantively driven assumptions. This page will walk you through those assumptions and help to refine your matrix to reflect the context of your study and research questions.   </p>

          <h3> The Monotonicity Assumption </h3>
          <p>Monotonicity assumption is that individual would be at least as likely to take up the treatment under assignment to the treatment condition as under assignment to the control condition. For example, if the treatment were assignment to receiving a new medication, it might be appropriate to assume that there are no patients who would take up the medication under assignment to the control group but not take up the medication under assignment to the treatment. In the matrix below, click any strata in which you think you can apply the Monotonicity assumption.</p>


          <table id="monoGrid" class="testgrid" align="center">
            <tr>
              <th colspan=5 class="control-treatment-header" id="group1Name"></th>
            </tr>
            <tr>
              <th rowspan=6 class="control-treatment-header" id="group2Name"></th>
            </tr>
            <tr>
              <th> </th>
              <th id="strata1Name"></th>
              <th id="strata2Name"></th>
              <th id="strata3Name"></th>
            </tr>
            <tr>
              <th id="strata1Name3"></th>
              <td id="strata1InputMono" onclick='tableText11_mono()'> </td>
              <td id="strata2InputMono" onclick='tableText12_mono()'> </td>
              <td id="strata3InputMono" onclick='tableText13_mono()'> </td>
            </tr>
            <tr>
              <th id="strata2Name3"></th>
              <td id="strata4InputMono" onclick='tableText21_mono()'> </td>
              <td id="strata5InputMono" onclick='tableText22_mono()'> </td>
              <td id="strata6InputMono" onclick='tableText23_mono()'> </td>
            </tr>
            <tr>
              <th id="strata3Name3"></th>
              <td id="strata7InputMono" onclick='tableText31_mono()'> </td>
              <td id="strata8InputMono" onclick='tableText32_mono()'> </td>
              <td id="strata9InputMono" onclick='tableText33_mono()'> </td>
            </tr>
          </table>

          <h3>Irrelevant Alternatives</h3>
          <p>Some strata may be theoretically possible but not plausible in the context of your study. For example, in the Feller et al. Head Start study it was plausible to assume that there were no participants who would enroll in a non-Head Start center care (condition 1) program if assigned to Head Start (treatment) but would take up Home-based (condition 2) care if assigned to the control group. There may be similar circumstances in your study. In the matrix below, click any strata which would you think represent irrelevant alternatives    
          </p>

          <table id="irrGrid" class="testgrid" align="center">
            <tr>
              <th colspan=5 class="control-treatment-header" id=group1Name2></th>
            </tr>
            <tr>
              <th rowspan=6 class="control-treatment-header" id=group2Name2></th>
            </tr>
            <tr>
              <th> </th>
              <th id=strata1Name2></th>
              <th id=strata2Name2></th>
              <th id=strata3Name2></th>
            </tr>
            <tr>
              <th id=strata1Name4></th>
              <td id=strata1InputIrr onclick='tableText11_irr()'> </td>
              <td id=strata2InputIrr onclick='tableText12_irr()'> </td>
              <td id=strata3InputIrr onclick='tableText13_irr()'> </td>
            </tr>
            <tr>
              <th id=strata2Name4></th>
              <td id=strata4InputIrr onclick='tableText21_irr()'></td>
              <td id=strata5InputIrr onclick='tableText22_irr()'> </td>
              <td id=strata6InputIrr onclick='tableText23_irr()'> </td>
            </tr>
            <tr>
              <th id=strata3Name4></th>
              <td id=strata7InputIrr onclick='tableText31_irr()'> </td>
              <td id=strata8InputIrr onclick='tableText32_irr()'> </td>
              <td id=strata9InputIrr onclick='tableText33_irr()'> </td>
            </tr>
          </table>


          

          <div class="row">
            <div class="small-12 text-center">
              <button class="button" onclick="moveToBounds()">Continue</button>
            </div>
          </div>


      </div> <!--/ end medium-7 -->

      
      

      <div class="medium-1 columns">&nbsp;
      </div>

    </div><!-- end row -->
    

    <footer>
      <div class="row expanded callout secondary">
        <div class="medium-10 medium-offset-1 columns">
      <p>Funding for this project was provided through a grant from Spencer Foundation. This website is designed to assist researchers interested in applying a principal stratification approach to their research questions. This tool intended for researchers who have a familiarity with the principal stratification approach. Researchers unfamiliar with the approach are encouraged to consult <a href="https://gspp.berkeley.edu/assets/uploads/research/pdf/Principal_Stratification.pdf" target="_blank">Page <em>et al</em> 2015 </a>  before using this tool. </p>

        </div>
      </div>


      <!--<div class="row">
        <div class="medium-12 columns text-center">
          <p><strong>Funding for this project was provided through a grant from Spencer Foundation</strong></p>
        </div>
      </div>-->

    </footer>
    
    <script src="js/vendor/jquery-2.1.4.min.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <script>

      window.onload = function() {
        var groupNames= new Array();
        var strataNames = new Array();
        var group1 = localStorage.group1Local;
        var group2 = localStorage.group2Local;
        var strata = localStorage.strataLocal;
        var strata1 = localStorage.strata1Local;
        var strata2 = localStorage.strata2Local;
        var strata3 = localStorage.strata3Local;
        var strata4 = localStorage.strata4Local;
        var strata1Input=localStorage.strata1Input;
        var strata2Input=localStorage.strata2Input;
        var strata3Input=localStorage.strata3Input;
        var strata4Input=localStorage.strata4Input;
        var strata5Input=localStorage.strata5Input;
        var strata6Input=localStorage.strata6Input;
        var strata7Input=localStorage.strata7Input;
        var strata8Input=localStorage.strata8Input;
        var strata9Input=localStorage.strata9Input;
        var strata10Input=localStorage.strata10Input;
        var strata11Input=localStorage.strata11Input;
        var strata12Input=localStorage.strata12Input;
        var strata13Input=localStorage.strata13Input;
        var strata14Input=localStorage.strata14Input;
        var strata15Input=localStorage.strata15Input;
        var strata16Input=localStorage.strata16Input;

        
        groupNames.push(group1);
        groupNames.push(group2);
        strataNames.push(strata1);
        strataNames.push(strata2);
        strataNames.push(strata3);
        strataNames.push(strata4);

        document.getElementById('group1Name').innerHTML = group1;
        document.getElementById('group2Name').innerHTML = group2;
        document.getElementById('group1Name2').innerHTML = group1;
        document.getElementById('group2Name2').innerHTML = group2;
        document.getElementById('strata1Name').innerHTML = strata1;
        document.getElementById('strata2Name').innerHTML = strata2;
        document.getElementById('strata3Name').innerHTML = strata3;
        document.getElementById('strata1Name2').innerHTML = strata1;
        document.getElementById('strata2Name2').innerHTML = strata2;
        document.getElementById('strata3Name2').innerHTML = strata3;
        document.getElementById('strata1Name3').innerHTML = strata1;
        document.getElementById('strata2Name3').innerHTML = strata2;
        document.getElementById('strata3Name3').innerHTML = strata3;
        document.getElementById('strata1Name4').innerHTML = strata1;
        document.getElementById('strata2Name4').innerHTML = strata2;
        document.getElementById('strata3Name4').innerHTML = strata3;
        document.getElementById("strata1InputMono").innerHTML = "Always "+strata1;
        document.getElementById("strata2InputMono").innerHTML = "If assigned to "+group1+" then takes up "+strata2+" and if assigned to "+group2+" then takes up "+strata1;
        document.getElementById("strata3InputMono").innerHTML = "If assigned to "+group1+" then takes up "+strata3+" and if assigned to "+group2+" then takes up "+strata1;
        document.getElementById("strata4InputMono").innerHTML = "If assigned to "+group1+" then takes up "+strata1+" and if assigned to "+group2+" then takes up "+strata2;
        document.getElementById('strata5InputMono').innerHTML = "Always "+strata2;
        document.getElementById('strata6InputMono').innerHTML = "If assigned to "+group1+" then takes up "+strata3+" and if assigned to "+group2+" then takes up "+strata2;
        document.getElementById('strata7InputMono').innerHTML = "If assigned to "+group1+" then takes up "+strata1+" and if assigned to "+group2+" then takes up "+strata2;
        document.getElementById('strata8InputMono').innerHTML = "If assigned to "+group1+" then takes up "+strata2+" and if assigned to "+group2+" then takes up "+strata3;
        document.getElementById('strata9InputMono').innerHTML = "Always "+strata3;
        document.getElementById("strata1InputIrr").innerHTML = "Always "+strata1;
        document.getElementById("strata2InputIrr").innerHTML = "If assigned to "+group1+" then takes up "+strata2+" and if assigned to "+group2+" then takes up "+strata1;
        document.getElementById("strata3InputIrr").innerHTML = "If assigned to "+group1+" then takes up "+strata3+" and if assigned to "+group2+" then takes up "+strata1;
        document.getElementById("strata4InputIrr").innerHTML = "If assigned to "+group1+" then takes up "+strata1+" and if assigned to "+group2+" then takes up "+strata2;
        document.getElementById('strata5InputIrr').innerHTML = "Always "+strata2;
        document.getElementById('strata6InputIrr').innerHTML = "If assigned to "+group1+" then takes up "+strata3+" and if assigned to "+group2+" then takes up "+strata2;
        document.getElementById('strata7InputIrr').innerHTML = "If assigned to "+group1+" then takes up "+strata1+" and if assigned to "+group2+" then takes up "+strata2;
        document.getElementById('strata8InputIrr').innerHTML = "If assigned to "+group1+" then takes up "+strata2+" and if assigned to "+group2+" then takes up "+strata3;
        document.getElementById('strata9InputIrr').innerHTML = "Always "+strata3;
        } 

  


function moveToBounds() {
  localStorage.cell1 = document.getElementById("strata1InputMono").innerHTML;
  localStorage.cell2 = document.getElementById("strata2InputMono").innerHTML;
  localStorage.cell3 = document.getElementById("strata3InputMono").innerHTML;
  localStorage.cell4 = document.getElementById("strata4InputMono").innerHTML;
  localStorage.cell5 = document.getElementById("strata5InputMono").innerHTML;
  localStorage.cell6 = document.getElementById("strata6InputMono").innerHTML;
  localStorage.cell7 = document.getElementById("strata7InputMono").innerHTML;
  localStorage.cell8 = document.getElementById("strata8InputMono").innerHTML;
  localStorage.cell9 = document.getElementById("strata9InputMono").innerHTML;
  //checks on whether enough eliminations
  var countRCACTIVE = 0;
  var count = 0;
  var countRow1 = 0;
  var countRow2 = 0;
  var countRow3 = 0;
  var countColumn1 = 0;
  var countColumn2 = 0;
  var countColumn3 = 0;
  
  if (localStorage.cell1.substring(0,2) == "Al"){
    countRow1 = countRow1 + 1;
    countColumn1 = countColumn1 + 1;
  }
  
  if (localStorage.cell2.substring(0,2) == "If"){
    countRow1 = countRow1 + 1;
    countColumn2 = countColumn2 + 1;
  }
  
  if (localStorage.cell3.substring(0,2) == "If"){
    countRow1 = countRow1 + 1;
    countColumn3 = countColumn3 + 1;
  }
  
  if (localStorage.cell4.substring(0,2) == "If"){
    countRow2 = countRow2 + 1;
    countColumn1 = countColumn1 + 1;
  }
  
  if (localStorage.cell5.substring(0,2) == "Al"){
    countRow2 = countRow2 + 1;
    countColumn2 = countColumn2 + 1;
  }

  if (localStorage.cell6.substring(0,2) == "If"){
    countRow2 = countRow2 + 1;
    countColumn3 = countColumn3 + 1;
  }

  if (localStorage.cell7.substring(0,2) == "If"){
    countRow3 = countRow3 + 1;
    countColumn1 = countColumn1 + 1;
  }

  if (localStorage.cell8.substring(0,2) == "If"){
    countRow3 = countRow3 + 1;
    countColumn2 = countColumn2 + 1;
  }

  if (localStorage.cell9.substring(0,2) == "Al"){
    countRow3 = countRow3 + 1;
    countColumn3 = countColumn3 + 1;
  }
  
  var isActive = [1,1,1,1,1,1,1,1,1];
  var cellsLocal = [localStorage.cell1, localStorage.cell2, localStorage.cell3, localStorage.cell4, localStorage.cell5, localStorage.cell6, localStorage.cell7, localStorage.cell8, localStorage.cell9];
  if (countRow1==3){countRCACTIVE = countRCACTIVE+1;}
  if (countRow2==3){countRCACTIVE = countRCACTIVE+1;}
  if (countRow3==3){countRCACTIVE = countRCACTIVE+1;}
  if (countColumn1==3){countRCACTIVE = countRCACTIVE+1;}
  if (countColumn2==3){countRCACTIVE = countRCACTIVE+1;}
  if (countColumn3==3){countRCACTIVE = countRCACTIVE+1;}
  for (var i = 0; i<9 ; i++)
  {
    if(cellsLocal[i].substring(0,2)!="Al" && cellsLocal[i].substring(0,2)!= "If"){
    count = count + 1;
    isActive[i] = 0;
    }
  }
  localStorage.countRow1 = countRow1;
  localStorage.countRow2 = countRow2;
  localStorage.countRow3 = countRow3;
  localStorage.countColumn1 = countColumn1;
  localStorage.countColumn2 = countColumn2;
  localStorage.countColumn3 = countColumn3;
  localStorage.isActive1 = isActive[0];
  localStorage.isActive2 = isActive[1];
  localStorage.isActive3 = isActive[2];
  localStorage.isActive4 = isActive[3];
  localStorage.isActive5 = isActive[4];
  localStorage.isActive6 = isActive[5];
  localStorage.isActive7 = isActive[6];
  localStorage.isActive8 = isActive[7];
  localStorage.isActive9 = isActive[8];
  if(count<3){alert("You must make 3 or more assumptions to use this tool.");}
  if(count>=3 & countRCACTIVE>1){alert("You can only have one full row or column still active in order to use this tool.");}
  if (count>4 || countRCACTIVE==0){
  alert("You can directly solve for the means under both treatment and control and you do not need bounds");
  window.location.href = 'noBoundsRedirect.html';
  }
  if (count>=3 & count<=4 & countRCACTIVE==1){window.location.href = 'bounds.html';}
  }
var row = new Array();
var column = new Array();

 var table = document.getElementById("irrGrid");
 var table2 = document.getElementById("monoGrid");


    function tableText11_mono() {
    document.getElementById("strata1InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata1InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata1InputMono").classList.add("blue-cell");
    document.getElementById("strata1InputIrr").classList.add("blue-cell");
    }

    function tableText12_mono() {
    document.getElementById("strata2InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata2InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata2InputMono").classList.add("blue-cell");
    document.getElementById("strata2InputIrr").classList.add("blue-cell");
    }

    function tableText13_mono() {
    document.getElementById("strata3InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata3InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata3InputMono").classList.add("blue-cell");
    document.getElementById("strata3InputIrr").classList.add("blue-cell");
    }

    function tableText21_mono() {
    document.getElementById("strata4InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata4InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata4InputMono").classList.add("blue-cell");
    document.getElementById("strata4InputIrr").classList.add("blue-cell");
    }

    function tableText22_mono() {
    document.getElementById("strata5InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata5InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata5InputMono").classList.add("blue-cell");
    document.getElementById("strata5InputIrr").classList.add("blue-cell");
    }

    function tableText23_mono() {
    document.getElementById("strata6InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata6InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata6InputMono").classList.add("blue-cell");
    document.getElementById("strata6InputIrr").classList.add("blue-cell");
    }

    function tableText31_mono() {
    document.getElementById("strata7InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata7InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata7InputMono").classList.add("blue-cell");
    document.getElementById("strata7InputIrr").classList.add("blue-cell");
    }

    function tableText32_mono() {
    document.getElementById("strata8InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata8InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata8InputMono").classList.add("blue-cell");
    document.getElementById("strata8InputIrr").classList.add("blue-cell");
    }

    function tableText33_mono() {
    document.getElementById("strata9InputMono").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata9InputIrr").innerHTML = "Monotonicity Assumption";
    document.getElementById("strata9InputMono").classList.add("blue-cell");
    document.getElementById("strata9InputIrr").classList.add("blue-cell");
    }

    function tableText11_irr() {
    document.getElementById("strata1InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata1InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata1InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata1InputIrr").setAttribute("bgColor","#808080");
    }

    function tableText12_irr() {
    document.getElementById("strata2InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata2InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata2InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata2InputIrr").setAttribute("bgColor","#808080");
    }

    function tableText13_irr() {
    document.getElementById("strata3InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata3InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata3InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata3InputIrr").setAttribute("bgColor","#808080");
    }

    function tableText21_irr() {
    document.getElementById("strata4InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata4InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata4InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata4InputIrr").setAttribute("bgColor","#808080");
    }

    function tableText22_irr() {
    document.getElementById("strata5InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata5InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata5InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata5InputIrr").setAttribute("bgColor","#808080");
    }

    function tableText23_irr() {
    document.getElementById("strata6InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata6InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata6InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata6InputIrr").setAttribute("bgColor","#808080");
    }

    function tableText31_irr() {
    document.getElementById("strata7InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata7InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata7InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata7InputIrr").setAttribute("bgColor","#808080");
    }

    function tableText32_irr() {
    document.getElementById("strata8InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata8InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata8InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata8InputIrr").setAttribute("bgColor","#808080");
    }

    function tableText33_irr() {
    document.getElementById("strata9InputMono").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata9InputIrr").innerHTML = "Irrelevant Alternative";
    document.getElementById("strata9InputMono").setAttribute("bgColor","#808080");
    document.getElementById("strata9InputIrr").setAttribute("bgColor","#808080");
    }

  
    </script>
  </body>
</html>



