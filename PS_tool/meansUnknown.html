<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solving the Remaining Means</title>
    <link rel="stylesheet" href="css/foundation.min.css">
    <link rel="stylesheet" href="css/app.css">
    <script src="js/mathjs-master/dist/math.js"></script>
  </head>
  <body>
    
    <div class="callout large primary">
      <div class="row column text-center">
        <h1>Principal Stratification Tool</h1>
      </div>
    </div>
    
    <div class="row" id="content">

      <div class="medium-3 medium-offset-1 columns" data-sticky-container>
        <div class="sticky" data-sticky data-anchor="content">
          <ol class="menu vertical">
            <li><a href="index.html"><strong>Start &raquo;</strong> Calculating Bounds for Principal Causal Effects: Interactive Analysis Tool</a></li>
            <li><a href="PS_tool.html">Identify the principal strata for your study</a></li>
            <li><a href="exclusions_3.html">Use substantive assumptions to constrain the number of strata forof interest for these analyses Determining proportions of subgroups using observed quantities</a></li>
            <li class="active"><a href="pUnknown.html">Solving for proportions that are not directly observed</a></li>
            <li>Solving for means under treatment and control</li>
            <li>Calculating the bounds and estimating ranges of impact</li>
            <li>Next steps</li>
          </ol>
        </div>
      </div>

      <div class="medium-7 columns">
        <div class="row column">
          <h2>Solving the Remaining Means</h2>
          
         <p id="tableInfo"> </p>
        
        <table id="boundsGrid" class="testgrid" align="center">
            <tr>
              <th colspan=5 class="control-treatment-header" id="group1Name"></th>
            </tr>
            <tr>
              <th rowspan=6 class="control-treatment-header" id="group2Name"></th>
            </tr>
            <tr>
              <th> </th>
              <th id="strata1Name"></th>
              <th id="strata2Name"></th>
              <th id="strata3Name"></th>
            </tr>
            <tr>
              <th id="strata1Name2"></th>
              <td id="strata1Input"> </td>
              <td id="strata2Input"> </td>
              <td id="strata3Input"> </td>
            </tr>
            <tr>
              <th id="strata2Name2"></th>
              <td id="strata4Input"> </td>
              <td id="strata5Input"> </td>
              <td id="strata6Input"> </td>
            </tr>
            <tr>
              <th id="strata3Name2"></th>
              <td id="strata7Input"> </td>
              <td id="strata8Input"> </td>
              <td id="strata9Input"> </td>
            </tr>
          </table>


        </div> <!--/ end blog post -->

        <div class="row column">
            <div class="small-12 text-center">
              <button class="button" onclick="submitP()">Continue</button>
            </div>
        </div>

      </div> <!--/ end medium- 7-->

      
      

      <div class="medium-1 columns">&nbsp; <!-- keep column empty, last column spans the remaining width of the page -->
      </div>

    </div><!--/ end row -->
    

    <footer>
      <div class="row expanded callout secondary">
        <div class="medium-10 medium-offset-1 columns">
      <p>Funding for this project was provided through a grant from Spencer Foundation. This website is designed to assist researchers interested in applying a principal stratification approach to their research questions. This tool intended for researchers who have a familiarity with the principal stratification approach. Researchers unfamiliar with the approach are encouraged to consult <a href="https://gspp.berkeley.edu/assets/uploads/research/pdf/Principal_Stratification.pdf" target="_blank">Page <em>et al</em> 2015 </a>  before using this tool. </p>

        </div>
      </div>


    </footer>
    
    <script src="js/vendor/jquery-2.1.4.min.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <script>

        window.onload = function() {
        var groupNames= new Array();
        var strataNames = new Array();
        var group1 = localStorage.group1Local;
        var group2 = localStorage.group2Local;
        var strata = localStorage.strataLocal;
        strata = strata*strata;
        var strata1 = localStorage.strata1Local;
        var strata2 = localStorage.strata2Local;
        var strata3 = localStorage.strata3Local;
        var isActive1 = parseInt(localStorage.isActive1);
        var isActive2 = parseInt(localStorage.isActive2);
        var isActive3 = parseInt(localStorage.isActive3);
        var isActive4 = parseInt(localStorage.isActive4);
        var isActive5 = parseInt(localStorage.isActive5);
        var isActive6 = parseInt(localStorage.isActive6);
        var isActive7 = parseInt(localStorage.isActive7);
        var isActive8 = parseInt(localStorage.isActive8);
        var isActive9 = parseInt(localStorage.isActive9);
        var isActive = [isActive1, isActive2, isActive3, isActive4, isActive5, isActive6, isActive7, isActive8, isActive9];
        var pMeanKnown1 = localStorage.pMeanKnown1;
        var pMeanKnown2 = localStorage.pMeanKnown2;
        var pMeanKnown3 = localStorage.pMeanKnown3;
        var pMeanKnown4 = localStorage.pMeanKnown4;
        var pMeanKnown5 = localStorage.pMeanKnown5;
        var pMeanKnown6 = localStorage.pMeanKnown6;
        var pMeanKnown7 = localStorage.pMeanKnown7;
        var pMeanKnown8 = localStorage.pMeanKnown8;
        var pMeanKnown9 = localStorage.pMeanKnown9;
        var pMeanKnown = [pMeanKnown1, pMeanKnown2, pMeanKnown3, pMeanKnown4, pMeanKnown5, pMeanKnown6, pMeanKnown7, pMeanKnown8, pMeanKnown9];
        var pMean1 = localStorage.pMean1;
        var pMean2 = localStorage.pMean2;
        var pMean3 = localStorage.pMean3;
        var pMean4 = localStorage.pMean4;
        var pMean5 = localStorage.pMean5;
        var pMean6 = localStorage.pMean6;
        var pMean7 = localStorage.pMean7;
        var pMean8 = localStorage.pMean8;
        var pMean9 = localStorage.pMean9;
        var pMean = [pMean1, pMean2, pMean3, pMean4, pMean5, pMean6, pMean7, pMean8, pMean9];
        var xMean1 = localStorage.xMeans1;
        var xMean2 = localStorage.xMeans2;
        var xMean3 = localStorage.xMeans3;
        var xMean4 = localStorage.xMeans4;
        var xMean5 = localStorage.xMeans5;
        var xMean6 = localStorage.xMeans6;
        var xMean7 = localStorage.xMeans7;
        var xMean8 = localStorage.xMeans8;
        var xMean9 = localStorage.xMeans9;
        var xMean = [xMean1, xMean2, xMean3, xMean4, xMean5, xMean6, xMean7, xMean8, xMean9];
        var yMean1 = localStorage.yMeans1;
        var yMean2 = localStorage.yMeans2;
        var yMean3 = localStorage.yMeans3;
        var yMean4 = localStorage.yMeans4;
        var yMean5 = localStorage.yMeans5;
        var yMean6 = localStorage.yMeans6;
        var yMean7 = localStorage.yMeans7;
        var yMean8 = localStorage.yMeans8;
        var yMean9 = localStorage.yMeans9;
        var yMean = [yMean1, yMean2, yMean3, yMean4, yMean5, yMean6, yMean7, yMean8, yMean9];
        var MeanKnown1 = localStorage.MeanKnown1;
        var MeanKnown2 = localStorage.MeanKnown2;
        var MeanKnown3 = localStorage.MeanKnown3;
        var MeanKnown4 = localStorage.MeanKnown4;
        var MeanKnown5 = localStorage.MeanKnown5;
        var MeanKnown6 = localStorage.MeanKnown6;
        var MeanKnown7 = localStorage.MeanKnown7;
        var MeanKnown8 = localStorage.MeanKnown8;
        var MeanKnown9 = localStorage.MeanKnown9;
        var MeanKnown = [MeanKnown1, MeanKnown2, MeanKnown3, MeanKnown4, MeanKnown5, MeanKnown6, MeanKnown7, MeanKnown8, MeanKnown9];
        var TtoTNum = localStorage.TtoTNum;
        var TtoSub1Num = localStorage.TtoSub1Num;
        var TtoSub2Num = localStorage.TtoSub2Num;
        var CtoTNum = localStorage.CtoTNum;
        var CtoSub1Num = localStorage.CtoSub1Num;
        var CtoSub2Num = localStorage.CtoSub2Num;
        var TtoT = localStorage.TtoT;
        var TtoSub1 = localStorage.TtoSub1;
        var TtoSub2 = localStorage.TtoSub2;
        var CtoT = localStorage.CtoT;
        var CtoSub1 = localStorage.CtoSub1;
        var CtoSub2 = localStorage.CtoSub2;
        document.getElementById('strata1Name').innerHTML = localStorage.strata1Local + " (Mean=" + TtoT + ")";
        document.getElementById('strata2Name').innerHTML = localStorage.strata2Local + " (Mean=" + TtoSub1 + ")";
        document.getElementById('strata3Name').innerHTML = localStorage.strata3Local + " (Mean=" + TtoSub2 + ")";
        document.getElementById('strata1Name2').innerHTML = localStorage.strata1Local + " (Mean=" + CtoT + ")";
        document.getElementById('strata2Name2').innerHTML = localStorage.strata2Local + " (Mean=" + CtoSub1 + ")";
        document.getElementById('strata3Name2').innerHTML = localStorage.strata3Local + " (Mean=" + CtoSub2 + ")";
        document.getElementById('group1Name').innerHTML = group1;
        document.getElementById('group2Name').innerHTML = group2;
        document.getElementById('tableInfo').innerHTML = "Knowing the means under "+group1+" and "+group2+" for some of the groups in the grid will allow the tool to solve for the remaining values. For example, we know that the means across a row or down a column must average out to the marginal mean in that row or column.  We also know the proportions of participants who are members of the groups represented by each cell in the grid. Using the means we can observe, and these proportions, we can back out some of the mean outcomes under "+group1+" and "+group2+".";
        //gray out excluded cells
        var C = "c";
        var cSub = C.sub();
        var T = "t"
        var tSub = T.sub()      
        var allCells = document.getElementsByTagName("td");
        for(var i = 0; i < strata; i++) {
          var node = allCells[i];
          var cellContent = node.childNodes[0].nodeValue; 
          if (isActive[i]==0)
            node.style.backgroundColor = "#808080";
          if(isActive[i]!=0)
            node.innerHTML = "P="+ pMean[i].substring(0,4)+"   Y"+tSub+"=" + xMean[i].substring(0,4)+"       Y"+cSub+"="+yMean[i].substring(0,4);
          if(MeanKnown[i]==0 & isActive[i]==1)
            node.style.backgroundColor = "#6495ED";

        }
      }
      
      function submitP(){
      window.location.href = 'bounds_calc.html';
      }

        
    </script>
  </body>
</html>



