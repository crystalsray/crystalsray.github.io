<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Identify the Principal Strata for Your Study</title>
    <link rel="stylesheet" href="css/foundation.min.css">
    <link rel="stylesheet" href="css/app.css">
    <!--<link rel="stylesheet" href="css/editablegrid.css" type="text/css" media="screen">-->
    <script src="js/mathjs-master/dist/math.js"></script>

  </head>
  <body>
    
    <!-- Start Top Bar -->
    <div class="top-bar">
      <div class="top-bar-left">
        <ul class="menu">
          <li class="menu-text">PS Tool</li>
        </ul>
      </div>
      <div class="top-bar-right">
        <ul class="menu">
          <li><a href="#">Menu 1</a></li>
          <li><a href="#">Menu 2</a></li>
          <li><a href="#">Menu 3</a></li>
          <li><a href="#">Menu 4</a></li>
        </ul>
      </div>
    </div>
    <!-- End Top Bar -->

    <div class="callout large primary">
      <div class="row column text-center">
        <h1>Principal Stratification Tool</h1>
      </div>
    </div>
    
    <div class="row" id="content">

      <div class="medium-2 medium-offset-1 columns" data-sticky-container>
        <div class="sticky" data-sticky data-anchor="content">
          <ol class="no-bullet">
            <li><a href="start.html">Start</a></li>
          </ol>
        </div>
      </div>

      <div class="medium-7 columns">

          <h2>Identify the Principal Strata for Your Study</h2>
          <h3> Setting up Your Model</h3>
          <h4> 1. How many groups are you interested in comparing? </h4>
          <p> The first step is to identify the number of post-randomization groups of interest for your proposed analyses. The number of groups will be determined by the potential behaviors of participants. For example, in the Feller et. al study on Head Start impacts, both treatment and control assigned children might enroll at a Head Start Center, at a non-Head Start Center or be cared for in a home based setting, for a total of 3 post randomization behaviors. In the ECHS example, a student could enroll at an ECHS, a high quality public school or a low quality public school. In cases such as these with three possible post-randomization behaviors, you would select 3 below. 
          </p>

          <div class="dropdown">
          <select name="Quantity" id="selection"> 
            <option value=0> </option> 
            <option value=2>2</option> 
            <option value=3>3</option> 
            <option value=4>4</option> 
          </select>
          </div>

          <h4> 2. What do you call the conditions in your study? </h4>
          <p> Principal stratification is a method designed for analyses of randomized control studies with units assigned to treatment and a control groups. By default, the tool will label to vertical axis as “Treatment” and the Horizontal axis as “Control” group names below. You may edit these fields to reflect the details of your study below.</p>

          <div id="namingGroups" class="header">
            <form action="demo_form.asp">
              <div class="row">
                <div class="medium-2 columns">
                  <label for="group1" >Treatment</label>
                </div>
                <div class="medium-10 columns">
                  <input type="text" id="group1" placeholder="Treatment">
                </div>
              </div>

              <div class="row">
                <div class="medium-2 columns">
                  <label for="group2">Control</labeL>
                </div>
                <div class="medium-10 columns">
                  <input type="text" id="group2" placeholder="Control"><br>
                </div>
              </div>

            </form>
          </div> 

          <h4> 3. What is the outcome of interest for your study? </h4>
          <p> Please Please indicate a dichotomous outcome of interest for your study </p>

          <form action="demo_form.asp">
            <div class="row">
                <div class="medium-2 columns">
                  <label for="outcome">Outcome</labeL>
                </div>
                <div class="medium-10 columns">
                  <input type="text" id="outcome" placeholder="Outcome...">
                </div>
              </div>
           </form>

          <h4> 4. What is the treatment control impact  on this outcome for your full sample? </h4>
          <p> Please enter in the outcome units rather effect size unit </p>
          <form action="demo_form.asp">
              <div class="row">
                <div class="medium-3 columns">
                  <label for="outcome_units">Outcome Units</labeL>
                </div>
                <div class="medium-9 columns">
                  <input type="text" id="outcome_units" placeholder="Outcome Units...">
                </div>
              </div>
           </form>

          <h4> 5. For which subgroups are you interested in calculating bounds for the effects of treatment? </h4>
          <p> Please label subgroups of interest for this study.  By default, the tool labels the conditions as  “Treatment”, “Subgroup1”, and “Subgroup2”. You may edit these fields to reflect the subgroups of interest for your study.</p>
          <div id="myDIV" class="header">
              <div class="row">
                <div class="medium-2 columns">
                  <label for="subgroup1">Treatment</label>
                </div>
                <div class="medium-10 columns">
                  <input type="text" id="subgroup1" placeholder="Treatment">
                </div>
              </div> <!--/row-->

              <div class="row">
                <div class="medium-2 columns">
                  <label for="subgroup2">Subgroup1</label>
                </div>
                <div class="medium-10 columns">
                  <input type="text" id="subgroup2" placeholder="Subgroup1">
                </div>
              </div><!--/row-->

              <div class="row">
                <div class="medium-2 columns">
                  <label for="subgroup3">Subgroup2</label>
                </div>
                <div class="medium-10 columns">
                  <input type="text" id="subgroup3" placeholder="Subgroup2">
                </div>
              </div><!--/row-->
          </div>

          <p id="exp" class="callout success"> </p>

          <div id="dvTable" align="center">

          </div>

          


        <div class="row">
            <div class="small-12 text-center">
              <button class="button" onclick="generateFunction()">Continue</button>
            </div>
        </div>

      </div> <!--/ end medium- 7-->

      
      <div class="medium-1 columns">&nbsp;</div>

    </div><!--/ end row -->
    

    <footer>
      <div class="row expanded callout secondary">
        <div class="medium-10 medium-offset-1 columns">
      <p>Funding for this project was provided through a grant from Spencer Foundation. This website is designed to assist researchers interested in applying a principal stratification approach to their research questions. This tool intended for researchers who have a familiarity with the principal stratification approach. Researchers unfamiliar with the approach are encouraged to consult <a href="https://gspp.berkeley.edu/assets/uploads/research/pdf/Principal_Stratification.pdf" target="_blank">Page <em>et al</em> 2015 </a>  before using this tool. </p>

        </div>
      </div>


      <!--<div class="row">
        <div class="medium-12 columns text-center">
          <p><strong>Funding for this project was provided through a grant from Spencer Foundation</strong></p>
        </div>
      </div>-->

    </footer>
    
    <script src="js/vendor/jquery-2.1.4.min.js"></script>
    <script src="js/vendor/foundation.js"></script>
    <!--<script type="text/javascript" src="../script/jquery.js"></script>
    <script type="text/javascript" src="../script/jquery.callback.js"></script>
    <script type="text/javascript" src="../script/ExportHTMLTable.js"></script>-->

   
  <script>

// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {

    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
  
}
// Get the continue button
var btn = document.getElementById("myBtn");


var strataName=new Array();
// Click on a close button to hide the current list item
var close = document.getElementsByClassName("close");
var i;
var closedNum=0
for (i = 0; i < close.length; i++) {
  close[i].onclick = function() {
    var div = this.parentElement;
    div.style.display = "hide";
  li.splice(i,1);
  }
}

var clickcount=0
var strataInput=new Array();
// When the user clicks the button, save value of dropdown and continue
function generateFunction() {
  $( ".callout.success" ).show(); //display #exp paragraph
  var select_value = document.getElementById('selection').value;
    var strata=select_value;
  var group1Name = document.getElementById("group1").value;
  var group2Name = document.getElementById("group2").value;
  var subgroup1Name = document.getElementById("subgroup1").value;
  var subgroup2Name = document.getElementById("subgroup2").value;
  var subgroup3Name = document.getElementById("subgroup3").value;
  var outcome = document.getElementById("outcome").value;
  var outcomeUnits = document.getElementById("outcome_units").value;
  if (group1Name==""){group1Name="Treatment"};
  if (group2Name==""){group2Name="Control"};
  if (subgroup1Name==""){subgroup1Name=group1Name};
  if (subgroup2Name==""){subgroup2Name="subgroup1"};
  if (subgroup3Name==""){subgroup3Name="subgroup2"};
  strataName.push(subgroup1Name);
  strataName.push(subgroup2Name);
  strataName.push(subgroup3Name);
  var table = document.createElement("TABLE");
  table.className += "testgrid"; //add testgrid styling
    table.border = "20";
  var columnCount = strata;
  

  //Add the data rows.
if (clickcount==0){
  //strataName.unshift(group1Name);
  strataName.unshift("");
    for (var i = 0; i <= columnCount; i++) {
        row = table.insertRow(-1);
        for (var j = 0; j < 1; j++) {
            var cell = row.insertCell(-1);
            cell.innerHTML = strataName[i];
      cell.setAttribute("width",150);
      if (i>0) {cell.setAttribute("bgColor","#D3D3D3")};
        }
    if(i==0) {
      var cell = row.insertCell(-1);
      cell.innerHTML = group1Name;
      cell.setAttribute("colspan",strata+1);
      cell.setAttribute("bgColor","white");
      var row=table.insertRow(-1);
      var cell = row.insertCell(-1);
      cell.innerHTML = group2Name;
      cell.setAttribute("rowspan",strata+1);
      cell.setAttribute("bgColor","white");
      cell.setAttribute("width",200);
      var row=table.insertRow(-1);
    for (var j = 0; j <= columnCount; j++) {
            var cell = row.insertCell(-1);
            cell.innerHTML = strataName[j];
      cell.setAttribute("bgColor","#D3D3D3")
        }
    }
    else {
    for (var j = 1; j <= columnCount; j++) {
            var cell = row.insertCell(-1);
      if(i==j){
      strataInput.push("Always " + strataName[i]);
      cell.innerHTML = "Always " + strataName[i];}
            else{
      cell.innerHTML = "If assigned to "+group1Name+" then takes up "+strataName[j]+" and if assigned to "+group2Name+" then takes up "+strataName[i];
      }
        }
    }
  }
    var dvTable = document.getElementById("dvTable");
    dvTable.innerHTML = "";
    dvTable.appendChild(table);
  localStorage.group1Local=group1Name;
  localStorage.group2Local=group2Name;
  localStorage.strataLocal=strata;
  document.getElementById('exp').innerHTML = "This matrix displays the "+ strata*strata + " possible strata for your study. Based on the information you entered, participants in the " + group1Name + " and " + group2Name + " groups could have taken up "+subgroup1Name+", "+subgroup2Name+", or "+subgroup3Name+".  On the next page you can eliminate strata for which you think there would be no impacts or that you believe are implausible.";
  }
  if(clickcount==1){
  localStorage.strata1Local=strataName[1];
  localStorage.strata2Local=strataName[2];
  localStorage.strata3Local=strataName[3];
  localStorage.strata4Local=strataName[4];
  localStorage.strata1Input=strataInput[1];
  localStorage.strata2Input=strataInput[2];
  localStorage.strata3Input=strataInput[3];
  localStorage.strata4Input=strataInput[4];
  localStorage.strata5Input=strataInput[5];
  localStorage.strata6Input=strataInput[6];
  localStorage.strata7Input=strataInput[7];
  localStorage.strata8Input=strataInput[8];
  localStorage.strata9Input=strataInput[8];
  localStorage.strata10Input=strataInput[10];
  localStorage.strata11Input=strataInput[11];
  localStorage.strata12Input=strataInput[12];
  localStorage.strata13Input=strataInput[13];
  localStorage.strata14Input=strataInput[14];
  localStorage.strata15Input=strataInput[15];
  localStorage.strata16Input=strataInput[16];
  localStorage.outcome = outcome;
  localStorage.outcomeUnits = outcomeUnits;
  if(strata==3){window.location.href = 'exclusions_3.html';}
  }
  clickcount=clickcount+1;
}
</script>
  </body>
</html>



