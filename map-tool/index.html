
<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Map Tool</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/custom.css" rel="stylesheet">

    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
        height: 400px;
        background-color: #ccc;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }


    </style>

  </head>

  <body>

    <!-- Navigation -->
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Map Tool</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Link <span class="sr-only">(current)</span></a></li>
            <li><a href="#">Link</a></li>
            
          </ul>

        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>

    <!-- Page Content -->
    <div class="container">

      <div class="row">
        <div class="col-lg-12 text-center">
          <h1 class="mt-5">Map Tool</h1>
        </div>
      </div>

      <div class="row">

        <div class="col-md-3">

          <!-- Select State -->
          <div class="form-group">
          <label for="states">Select State</label>
            <select id="states" class="form-control" onchange="selectedState()">
              <option disabled selected>Select State</option>
              <option>Don't Know</option>
              <option>Connecticut</option>
              <option>Maine</option>
              <option>Massachusetts</option>
              <option>New Hampshire</option>
              <option>Rhode Island</option>
            </select>
          </div> <!--/ .form-group -->


          <!-- Select Conneticut Town -->
          <div class="form-group" id="groupConnecticutTowns">
          <label for="conneticutTowns">Select Town</label>
            <select id="conneticutTowns" class="form-control" onchange="selectedTown('conneticutTowns')">
              <option disabled selected>Select a town/city</option><option>Don't Know</option><option>Addison</option><option>Alna</option><option>Arrowsic</option><option>Arundel</option><option>Bar Harbor</option><option>Bath Cty</option><option>Beals</option><option>Belfast Cty</option><option>Biddeford Cty</option><option>Bluehill</option><option>Boothbay</option><option>Boothbay Harbor</option><option>Breman</option><option>Bristol</option><option>Brooklin</option><option>Brooksville</option><option>Brunswick</option><option>Bucksport</option><option>Calais Cty</option><option>Camden</option><option>Cape Elizabeth</option><option>Castine</option><option>Centerville</option><option>Cherryfield</option><option>Columbia</option><option>Columbia Falls</option><option>Cranberry Isles</option><option>Cumberland</option><option>Cushing</option><option>Cutler</option><option>Damariscotta</option><option>Deer Isle</option><option>East Machias</option><option>Eastport Cty</option><option>Edgecomb</option><option>Edmunds</option><option>Eliot</option><option>Ellsworth Cty</option><option>Falmouth</option><option>Frankfort</option><option>Franklin</option><option>Freeport</option><option>Frenchboro</option><option>Friendship</option><option>Georgetown</option><option>Gouldsboro</option><option>Hancock</option><option>Harpswell</option><option>Harrington</option><option>Isle Au Haut</option><option>Isle Boro</option><option>Jonesboro</option><option>Jonesport</option><option>Kennebunk</option><option>Kennebunkport</option><option>Kittery</option><option>Lamoine</option><option>Lincolnville</option><option>Lubec</option><option>Machias</option><option>Machiasport</option><option>Marshfield</option><option>Milbridge</option><option>Mount Desert</option><option>Newcastle</option><option>North Haven</option><option>North Port</option><option>North Yarmouth</option><option>Ogunquit</option><option>Old Orchard Beach</option><option>Orland</option><option>Owlshead</option><option>Pembroke</option><option>Penobscot</option><option>Perry</option><option>Phippsburg</option><option>Portland Cty</option><option>Pownall</option><option>Prospect</option><option>Robinston</option><option>Rockland Cty</option><option>Rockport</option><option>Roque Bluffs</option><option>Saco Cty</option><option>Scarborough</option><option>Searsport</option><option>Sedgewick</option><option>Sorrento</option><option>South Berick</option><option>South Bristol</option><option>South Portland Cty</option><option>South Thomaston</option><option>South West Harbor</option><option>Southport</option><option>St George</option><option>Steuben</option><option>Stockton Springs</option><option>Stonington</option><option>Sullivan</option><option>Surry</option><option>Swans Island</option><option>Swanville</option><option>Thomaston</option><option>Topsham</option><option>Tremont</option><option>Trenton</option><option>Trescott Twp</option><option>Verona</option><option>Waldoboro</option><option>Warren</option><option>Wells</option><option>West Bath</option><option>Westbrook Cty</option><option>Westport</option><option>Whiting</option><option>Whitneyville</option><option>Winter Harbor</option><option>Wisscasset</option><option>Woolwich</option><option>Yarmouth</option><option>York</option>
            </select>
          </div> <!--/ .form-group --> 

          <div class="form-group" id="groupMaineTowns">
            <label for="maineTowns">Select Town</label>
            <select class="form-control" id="maineTowns" onchange="selectedTown('maineTowns')">
              <option disabled selected>Select a town/city</option><option>Don't Know</option><option>Addison</option><option>Alna</option><option>Arrowsic</option><option>Arundel</option><option>Bar Harbor</option><option>Bath Cty</option><option>Beals</option><option>Belfast Cty</option><option>Biddeford Cty</option><option>Bluehill</option><option>Boothbay</option><option>Boothbay Harbor</option><option>Breman</option><option>Bristol</option><option>Brooklin</option><option>Brooksville</option><option>Brunswick</option><option>Bucksport</option><option>Calais Cty</option><option>Camden</option><option>Cape Elizabeth</option><option>Castine</option><option>Centerville</option><option>Cherryfield</option><option>Columbia</option><option>Columbia Falls</option><option>Cranberry Isles</option><option>Cumberland</option><option>Cushing</option><option>Cutler</option><option>Damariscotta</option><option>Deer Isle</option><option>East Machias</option><option>Eastport Cty</option><option>Edgecomb</option><option>Edmunds</option><option>Eliot</option><option>Ellsworth Cty</option><option>Falmouth</option><option>Frankfort</option><option>Franklin</option><option>Freeport</option><option>Frenchboro</option><option>Friendship</option><option>Georgetown</option><option>Gouldsboro</option><option>Hancock</option><option>Harpswell</option><option>Harrington</option><option>Isle Au Haut</option><option>Isle Boro</option><option>Jonesboro</option><option>Jonesport</option><option>Kennebunk</option><option>Kennebunkport</option><option>Kittery</option><option>Lamoine</option><option>Lincolnville</option><option>Lubec</option><option>Machias</option><option>Machiasport</option><option>Marshfield</option><option>Milbridge</option><option>Mount Desert</option><option>Newcastle</option><option>North Haven</option><option>North Port</option><option>North Yarmouth</option><option>Ogunquit</option><option>Old Orchard Beach</option><option>Orland</option><option>Owlshead</option><option>Pembroke</option><option>Penobscot</option><option>Perry</option><option>Phippsburg</option><option>Portland Cty</option><option>Pownall</option><option>Prospect</option><option>Robinston</option><option>Rockland Cty</option><option>Rockport</option><option>Roque Bluffs</option><option>Saco Cty</option><option>Scarborough</option><option>Searsport</option><option>Sedgewick</option><option>Sorrento</option><option>South Berick</option><option>South Bristol</option><option>South Portland Cty</option><option>South Thomaston</option><option>South West Harbor</option><option>Southport</option><option>St George</option><option>Steuben</option><option>Stockton Springs</option><option>Stonington</option><option>Sullivan</option><option>Surry</option><option>Swans Island</option><option>Swanville</option><option>Thomaston</option><option>Topsham</option><option>Tremont</option><option>Trenton</option><option>Trescott Twp</option><option>Verona</option><option>Waldoboro</option><option>Warren</option><option>Wells</option><option>West Bath</option><option>Westbrook Cty</option><option>Westport</option><option>Whiting</option><option>Whitneyville</option><option>Winter Harbor</option><option>Wisscasset</option><option>Woolwich</option><option>Yarmouth</option><option>York</option>
            </select>
          </div>

          <div class="form-group" id="groupMassachusettsTowns">
            <label for="">Select Town</label>
            <select class="form-control" id="massachusettsTowns" onchange="selectedTown('massachusettsTowns')">
              <option disabled selected>Select a town/city</option><option>Don't Know</option><option>Acushnet</option><option>Aquinnah</option><option>Barnstable</option><option>Berkley</option><option>Beverly</option><option>Boston</option><option>Bourne</option><option>Braintree</option><option>Brewster</option><option>Brookline</option><option>Cambridge</option><option>Chatham</option><option>Chelsea</option><option>Chilmark</option><option>Cohasset</option><option>Danvers</option><option>Dartmouth</option><option>Dennis</option><option>Dighton</option><option>Duxbury</option><option>Eastham</option><option>Edgartown</option><option>Essex</option><option>Everett</option><option>Fairhaven</option><option>Fall River</option><option>Falmouth</option><option>Freetown</option><option>Gloucester</option><option>Gosnold</option><option>Hamilton</option><option>Harwich</option><option>Hingham</option><option>Hull</option><option>Ipswich</option><option>Kingston</option><option>Lynn</option><option>Malden</option><option>Manchester</option><option>Marblehead</option><option>Marion</option><option>Marshfield</option><option>Mashpee</option><option>Mattapoisett</option><option>Medford</option><option>Milton</option><option>Nahant</option><option>Nantucket</option><option>New Bedford</option><option>Newbury</option><option>Newburyport</option><option>Norwell</option><option>Oak Bluffs</option><option>Orleans</option><option>Peabody</option><option>Plymouth</option><option>Provincetown</option><option>Quincy</option><option>Rehoboth</option><option>Revere</option><option>Rochester</option><option>Rockport</option><option>Rowley</option><option>Salem</option><option>Salisbury</option><option>Sandwich</option><option>Saugus</option><option>Scituate</option><option>Seekonk</option><option>Somerset</option><option>Somerville</option><option>Swampscott</option><option>Swansea</option><option>Tisbury</option><option>Truro</option><option>Wareham</option><option>Wellfleet</option><option>Wenham</option><option>West Tisbury</option><option>Westport</option><option>Weymouth</option><option>Winthrop</option><option>Yarmouth</option>
            </select>
          </div>


          <div class="form-group" id="groupNewHampshireTowns">
          <label for="newHampshireTowns">Select Town </label>
            <select class="form-control" id="newHampshireTowns" onchange="selectedTown('newHampshireTowns')">
              <option disabled selected>Select a town/city</option><option>Don't Know</option><option>Atkinson</option><option>Brentwood</option><option>Danville</option><option>Dover</option><option>Durham</option><option>East Kingston</option><option>Epping</option><option>Exeter</option><option>Fremont</option><option>Greenland</option><option>Hampstead</option><option>Hampton</option><option>Hampton Falls</option><option>Kensington</option><option>Kingston</option><option>Lee</option><option>Madbury</option><option>New Castle</option><option>Newfields</option><option>Newington</option><option>Newmarket</option><option>Newton</option><option>North Hampton</option><option>Plaistow</option><option>Portsmouth</option><option>Rollinsford</option><option>Rye</option><option>Seabrook</option><option>Somersworth</option><option>South Hampton</option><option>Stratham</option>
            </select>
          </div>


          <div class="form-group" id="groupRhodeIslandTowns">
          <label for="rhodeIslandTowns">Select Town </label>
            <select class="form-control" id="rhodeIslandTowns" onchange="selectedTown('rhodeIslandTowns')">
              <option disabled selected>Select a town/city</option><option>Don't Know</option><option>Barrington</option><option>Bristol</option><option>Charlestown</option><option>Cranston</option><option>East Greenwich</option><option>East Providence</option><option>Exeter</option><option>Hopkinton</option><option>Jamestown</option><option>Little Compton</option><option>Middletown</option><option>Narragansett</option><option>Newport</option><option>North Kingstown</option><option>North Providence</option><option>Pawtucket</option><option>Portsmouth</option><option>Providence</option><option>South Kingstown</option><option>Tiverton</option><option>Warren</option><option>Warwick</option><option>Westerly</option>
            </select>
          </div>


          <!-- Select Place -->

          <div id="groupPlaceName">

          <div class="form-group">
            <label for="placeName">Name of Place</label>
            <input type="text" class="form-control" placeholder="Enter place name" id="placeName">
            <small><span class="help-block text-muted">Examples: beach name, street name, marina, or park name.</span></small>
          </div> <!--/ .form-group -->




          <button type="button" class="btn btn-default btn-block" aria-label="Left Align" onclick="placeName('placeName')">
            <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Search
          </button>

          </div>


          <!-- Instructions to place pin -->
          <div id="pinInstructions">
           <br>
              <div class="bg-danger">
                <p class="text-center"><strong>Place Pin on the Map</strong></p>
                <p>The place has not been found. Use the controls on the map to pan and zoom to location and <em>click</em> on the map to add a pin.</p>
              </div>
          </div>


          <!-- Pn Instructions if state isn't selected -->
          <div id="pinInfoState">
           <br>
           <div class="bg-info" style="padding: 10px;">
             <p class="text-center"><strong>Place Pin on the Map</strong></p>
             <p>Use the controls on the map to pan and zoom to location and click on the map to add a pin.</p>
           </div>
          </div>


          <!-- Confirmation -->
          <div id="confirm">
          <br>
            <div class="bg-success">
             <p class="text-center"><strong>Confirm Location</strong></p>
             <p>Confirm text lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc vitae massa dignissim, mollis tortor at, pharetra nunc. Nullam vitae fringilla ex.</p>
             <input class="btn btn-success btn-block" type="submit" value="Confirm Location">
            </div>
          </div>
          

        </div> <!--/ .col-md-3 -->

        <div class="col-md-9">

          <!-- Show map -->
          <div id="map"></div>

        </div> <!-- / .col-md-9 -->

      </div> <!--/ .row -->

      <div class="row">
        <div class="col-md-12">
          <hr>
          <p> <strong>Developer's return value </strong></p>
          <p id="devReturnVal"></p>
        </div>
      </div>

    </div>

    <!-- Bootstrap core JavaScript -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

    <script>

           var geocoder;
           var infowindow;
           var map;
           var marker;
           var returnVal;

           var town;
           var state;
           var place;

           var pinInfo = document.getElementById("pinInstructions");
           var confirm = document.getElementById("confirm");
           var statePinInfo = document.getElementById("pinInfoState");

           //hide other towns
          var ct = document.getElementById("groupConnecticutTowns");
          var mn = document.getElementById("groupMaineTowns");
          var ma = document.getElementById("groupMassachusettsTowns");
          var ri = document.getElementById("groupRhodeIslandTowns");
          var nh = document.getElementById("groupNewHampshireTowns");


            function initMap() {
              map = new google.maps.Map(document.getElementById('map'), {
                mapTypeId: google.maps.MapTypeId.HYBRID,
                zoom: 6,
                streetViewControl: false,
                scaleControl: true,
                center: {lat: 44.247658, lng: -71.553955}
              });

              geocoder = new google.maps.Geocoder();
              infowindow = new google.maps.InfoWindow; //for dropped pin

              /*var autoInput = document.getElementById("placeName");
              var autocomplete = new google.maps.places.Autocomplete(autoInput);
              autocomplete.setComponentRestrictions({
                  'country': ['us']
              });*/

              google.maps.event.addListener(map, 'click', function (evt) {
                placeMarker(evt.latLng);
              });

            }


            function placeMarker(location) {
            console.log("placeMarker()");
              if (marker) {
                  //if marker already was created change positon
                  marker.setPosition(location);
              } else {
                  //create a marker
                  marker = new google.maps.Marker({          
                      position: location,
                      map: map,
                      draggable: true
                  });  
              }

              // change lat/lng coordinates to readable text
              var input = marker.getPosition();
              var latlng = {lat: input.lat(), lng: input.lng()};
              geocoder.geocode({'location': latlng}, function(results, status) {
                if (status === 'OK') { 
                  returnVal = results[0].formatted_address;
                  infowindow.setContent(results[0].formatted_address);
                  infowindow.open(map, marker); 
                  updateDevValue(returnVal);

                  //check if Pin is added in correct place
                  pinInfo.style.display = "none";
                  confirm.style.display = "block";

                } 
                else { 
                   window.alert('No results found'); 
                 }
              }); // end geocoder 

              
            }


            function updateDevValue (val) {
              //update return value for the developer
              returnVal = val;
              document.getElementById("devReturnVal").innerHTML = returnVal;
            }


            function geocodeLocation(geocoder, resultsMap, location, zoom) {
              console.log('geocodeLocation()');
              geocoder.geocode({'address': location}, function(results, status) {
                if (status === 'OK') {
                  resultsMap.setCenter(results[0].geometry.location);
                  //map.setZoom(zoom);
                  map.fitBounds(results[0].geometry.viewport);
                  if (place) {
                      marker = new google.maps.Marker({
                        map: resultsMap,
                        position: results[0].geometry.location
                      });
                      infowindow.setContent(results[0].formatted_address);
                      infowindow.open(map, marker);
                      //update the return value for the developer
                      updateDevValue(results[0].formatted_address);
                      confirm.style.display = "block";
                  }
                } else {
                  pinInfo.style.display = "block"; // show instructional text to drop a pin
                  confirm.style.display = "none";
                  //alert('Geocode was not successful for the following reason: ' + status);
                }
              });
            }


            function selectedState() {
              state = document.getElementById("states").value;
              var zoom = 8; //find way to fit state

              console.log(state);

              if (state === "Don't Know") {
                //show instructions for dropping a pin 
                statePinInfo.style.display = "block";
                hideTowns();
              }

              else {
                geocodeLocation(geocoder, map, state, zoom);
                showTowns(state);

                //hide Pin Instructions incase  users changes selection from "Don't Know" to State
                statePinInfo.style.display = "none";

                //update the return value for the developer
                updateDevValue(state);
              }

              // if marker exists, delete marker
              if (marker) {
                  marker.setMap(null);
              } 
              
            }


            function hideTowns() {
              ct.style.display = "none";
              mn.style.display = "none";
              ma.style.display = "none";
              ri.style.display = "none";
              nh.style.display = "none";
            }

            function showTowns(state) {

              hideTowns();

              //show towns for selected state
              if (state==="Connecticut") {
                ct.style.display = "block"; 
              }
              else if (state==="Maine") {
                mn.style.display = "block";
              }

              else if (state==="Massachusetts")  {
                ma.style.display = "block";
              }

              else if (state==="Rhode Island")  {
                ri.style.display = "block";
              }

              else  { //New Hampshire
                  nh.style.display = "block";
              } 

            }


            function selectedTown(townID) {
              //center map on town
              town = document.getElementById(townID).value;
              var location;

              if (town==="Don't Know") {
                location= state; // exclude town if "Don't Know" is chosen
              }
              else {
                location= town + ", " + state;
              }
               
              var zoom = 14;

              geocodeLocation(geocoder, map, location, zoom);
              var placeName = document.getElementById("groupPlaceName");
              placeName.style.display = "block";

              //update the return value for the developer
              updateDevValue(location);
            }


            function placeName(placeID) {
              place = document.getElementById("placeName").value;
              var location;

              if (town==="Don't Know") {
                location= place + ", " + state; // exclude town if "Don't Know" is chosen
              }
              else {
                location = place + ", " + town + ", " + state;
              }

              console.log(location);
              var zoom = 20;

              geocodeLocation(geocoder, map, location, zoom);  

              //update the return value for the developer
              updateDevValue(location);
                          
            }



    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBOlaySnzB2tBKFR3us5byUMV96cbcZYoY&callback=initMap&libraries=places""></script>

  </body>

</html>
